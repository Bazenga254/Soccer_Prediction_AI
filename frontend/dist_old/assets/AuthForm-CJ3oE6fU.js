import{r as p,a as pt,u as mt,j as s,c as ft}from"./index-B3SC9TNl.js";import{C as gt}from"./CountryPicker-UwHd2W_3.js";var xt=Object.defineProperty,vt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,pe=(e,t,r)=>t in e?xt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,j=(e,t)=>{for(var r in t||(t={}))Ie.call(t,r)&&pe(e,r,t[r]);if(ee)for(var r of ee(t))Fe.call(t,r)&&pe(e,r,t[r]);return e},Me=(e,t)=>vt(e,yt(t)),bt=(e,t)=>{var r={};for(var n in e)Ie.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&ee)for(var n of ee(e))t.indexOf(n)<0&&Fe.call(e,n)&&(r[n]=e[n]);return r},x=(e,t,r)=>(pe(e,typeof t!="symbol"?t+"":t,r),r),M=(e,t,r)=>new Promise((n,c)=>{var i=u=>{try{h(r.next(u))}catch(d){c(d)}},l=u=>{try{h(r.throw(u))}catch(d){c(d)}},h=u=>u.done?n(u.value):Promise.resolve(u.value).then(i,l);h((r=r.apply(e,t)).next())}),wt="hCaptcha-script",Z="hCaptchaOnLoad",Le="script-error",L="@hCaptcha/loader";function jt(e){return Object.entries(e).filter(([,t])=>t||t===!1).map(([t,r])=>`${encodeURIComponent(t)}=${encodeURIComponent(String(r))}`).join("&")}function Be(e){let t=e&&e.ownerDocument||document,r=t.defaultView||t.parentWindow||window;return{document:t,window:r}}function $e(e){return e||document.head}function Ct(e){var t;e.setTag("source",L),e.setTag("url",document.URL),e.setContext("os",{UA:navigator.userAgent}),e.setContext("browser",j({},kt())),e.setContext("device",Me(j({},Rt()),{screen_width_pixels:screen.width,screen_height_pixels:screen.height,language:navigator.language,orientation:((t=screen.orientation)==null?void 0:t.type)||"Unknown",processor_count:navigator.hardwareConcurrency,platform:navigator.platform}))}function kt(){var e,t,r,n,c,i;let l=navigator.userAgent,h,u;return l.indexOf("Firefox")!==-1?(h="Firefox",u=(e=l.match(/Firefox\/([\d.]+)/))==null?void 0:e[1]):l.indexOf("Edg")!==-1?(h="Microsoft Edge",u=(t=l.match(/Edg\/([\d.]+)/))==null?void 0:t[1]):l.indexOf("Chrome")!==-1&&l.indexOf("Safari")!==-1?(h="Chrome",u=(r=l.match(/Chrome\/([\d.]+)/))==null?void 0:r[1]):l.indexOf("Safari")!==-1&&l.indexOf("Chrome")===-1?(h="Safari",u=(n=l.match(/Version\/([\d.]+)/))==null?void 0:n[1]):l.indexOf("Opera")!==-1||l.indexOf("OPR")!==-1?(h="Opera",u=(c=l.match(/(Opera|OPR)\/([\d.]+)/))==null?void 0:c[2]):l.indexOf("MSIE")!==-1||l.indexOf("Trident")!==-1?(h="Internet Explorer",u=(i=l.match(/(MSIE |rv:)([\d.]+)/))==null?void 0:i[2]):(h="Unknown",u="Unknown"),{name:h,version:u}}function Et(e){return new Promise(t=>setTimeout(t,e))}function Rt(){let e=navigator.userAgent,t;e.indexOf("Win")!==-1?t="Windows":e.indexOf("Mac")!==-1?t="Mac":e.indexOf("Linux")!==-1?t="Linux":e.indexOf("Android")!==-1?t="Android":e.indexOf("like Mac")!==-1||e.indexOf("iPhone")!==-1||e.indexOf("iPad")!==-1?t="iOS":t="Unknown";let r;return/Mobile|iPhone|iPod|Android/i.test(e)?r="Mobile":/Tablet|iPad/i.test(e)?r="Tablet":r="Desktop",{model:t,family:t,device:r}}var Nt=class We{constructor(t){x(this,"_parent"),x(this,"breadcrumbs",[]),x(this,"context",{}),x(this,"extra",{}),x(this,"tags",{}),x(this,"request"),x(this,"user"),this._parent=t}get parent(){return this._parent}child(){return new We(this)}setRequest(t){return this.request=t,this}removeRequest(){return this.request=void 0,this}addBreadcrumb(t){return typeof t.timestamp>"u"&&(t.timestamp=new Date().toISOString()),this.breadcrumbs.push(t),this}setExtra(t,r){return this.extra[t]=r,this}removeExtra(t){return delete this.extra[t],this}setContext(t,r){return typeof r.type>"u"&&(r.type=t),this.context[t]=r,this}removeContext(t){return delete this.context[t],this}setTags(t){return this.tags=j(j({},this.tags),t),this}setTag(t,r){return this.tags[t]=r,this}removeTag(t){return delete this.tags[t],this}setUser(t){return this.user=t,this}removeUser(){return this.user=void 0,this}toBody(){let t=[],r=this;for(;r;)t.push(r),r=r.parent;return t.reverse().reduce((n,c)=>{var i;return n.breadcrumbs=[...(i=n.breadcrumbs)!=null?i:[],...c.breadcrumbs],n.extra=j(j({},n.extra),c.extra),n.contexts=j(j({},n.contexts),c.context),n.tags=j(j({},n.tags),c.tags),c.user&&(n.user=c.user),c.request&&(n.request=c.request),n},{breadcrumbs:[],extra:{},contexts:{},tags:{},request:void 0,user:void 0})}clear(){this.breadcrumbs=[],this.context={},this.tags={},this.user=void 0}},St=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,_t=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js))(?::(\d+))?(?::(\d+))?\s*$/i,Ot=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Lt=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/,X="?",Pe="An unknown error occurred",Pt="0.0.4";function At(e){for(let t=0;t<e.length;t++)e[t]=Math.floor(Math.random()*256);return e}function y(e){return(e+256).toString(16).substring(1)}function qt(){let e=At(new Array(16));return e[6]=e[6]&15|64,e[8]=e[8]&63|128,y(e[0])+y(e[1])+y(e[2])+y(e[3])+"-"+y(e[4])+y(e[5])+"-"+y(e[6])+y(e[7])+"-"+y(e[8])+y(e[9])+"-"+y(e[10])+y(e[11])+y(e[12])+y(e[13])+y(e[14])+y(e[15])}var Tt=[[St,"chrome"],[Ot,"winjs"],[_t,"gecko"]];function It(e){var t,r,n,c;if(!e.stack)return null;let i=[],l=(n=(r=(t=e.stack).split)==null?void 0:r.call(t,`
`))!=null?n:[];for(let h=0;h<l.length;++h){let u=null,d=null,v=null;for(let[k,_]of Tt)if(d=k.exec(l[h]),d){v=_;break}if(!(!d||!v)){if(v==="chrome")u={filename:(c=d[2])!=null&&c.startsWith("address at ")?d[2].substring(11):d[2],function:d[1]||X,lineno:d[3]?+d[3]:null,colno:d[4]?+d[4]:null};else if(v==="winjs")u={filename:d[2],function:d[1]||X,lineno:+d[3],colno:d[4]?+d[4]:null};else if(v==="gecko")h===0&&!d[5]&&e.columnNumber!==void 0&&i.length>0&&(i[0].column=e.columnNumber+1),u={filename:d[3],function:d[1]||X,lineno:d[4]?+d[4]:null,colno:d[5]?+d[5]:null};else continue;!u.function&&u.lineno&&(u.function=X),i.push(u)}}return i.length?i.reverse():null}function Ft(e){let t=It(e);return{type:e.name,value:e.message,stacktrace:{frames:t??[]}}}function Mt(e){let t=Lt.exec(e),r=t?t.slice(1):[];if(r.length!==6)throw new Error("Invalid DSN");let n=r[5].split("/"),c=n.slice(0,-1).join("/");return r[0]+"://"+r[3]+(r[4]?":"+r[4]:"")+(c?"/"+c:"")+"/api/"+n.pop()+"/envelope/?sentry_version=7&sentry_key="+r[1]+(r[2]?"&sentry_secret="+r[2]:"")}function Bt(e,t,r){var n,c;let i=j({event_id:qt().replaceAll("-",""),platform:"javascript",sdk:{name:"@hcaptcha/sentry",version:Pt},environment:t,release:r,timestamp:Date.now()/1e3},e.scope.toBody());if(e.type==="exception"){i.message=(c=(n=e.error)==null?void 0:n.message)!=null?c:"Unknown error",i.fingerprint=[i.message];let l=[],h=e.error;for(let u=0;u<5&&h&&(l.push(Ft(h)),!(!h.cause||!(h.cause instanceof Error)));u++)h=h.cause;i.exception={values:l.reverse()}}return e.type==="message"&&(i.message=e.message,i.level=e.level),i}function $t(e){if(e instanceof Error)return e;if(typeof e=="string")return new Error(e);if(typeof e=="object"&&e!==null&&!Array.isArray(e)){let r=e,{message:n}=r,c=bt(r,["message"]),i=new Error(typeof n=="string"?n:Pe);return Object.assign(i,c)}let t=new Error(Pe);return Object.assign(t,{cause:e})}function Wt(e,t,r){return M(this,null,function*(){var n,c;try{if(typeof fetch<"u"&&typeof AbortSignal<"u"){let i;if(r){let u=new AbortController;i=u.signal,setTimeout(()=>u.abort(),r)}let l=yield fetch(e,Me(j({},t),{signal:i})),h=yield l.text();return{status:l.status,body:h}}return yield new Promise((i,l)=>{var h,u;let d=new XMLHttpRequest;if(d.open((h=t?.method)!=null?h:"GET",e),d.onload=()=>i({status:d.status,body:d.responseText}),d.onerror=()=>l(new Error("XHR Network Error")),t?.headers)for(let[v,k]of Object.entries(t.headers))d.setRequestHeader(v,k);if(r){let v=setTimeout(()=>{d.abort(),l(new Error("Request timed out"))},r);d.onloadend=()=>{clearTimeout(v)}}d.send((u=t?.body)==null?void 0:u.toString())})}catch(i){return{status:0,body:(c=(n=i?.toString)==null?void 0:n.call(i))!=null?c:"Unknown error"}}})}var b,me=(b=class{constructor(e){x(this,"apiURL"),x(this,"dsn"),x(this,"environment"),x(this,"release"),x(this,"sampleRate"),x(this,"debug"),x(this,"_scope"),x(this,"shouldBuffer",!1),x(this,"bufferlimit",20),x(this,"buffer",[]);var t,r,n,c,i;this.environment=e.environment,this.release=e.release,this.sampleRate=(t=e.sampleRate)!=null?t:1,this.debug=(r=e.debug)!=null?r:!1,this._scope=(n=e.scope)!=null?n:new Nt,this.apiURL=Mt(e.dsn),this.dsn=e.dsn,this.shouldBuffer=(c=e.buffer)!=null?c:!1,this.bufferlimit=(i=e.bufferLimit)!=null?i:20}static init(e){b._instance||(b._instance=new b(e))}static get instance(){if(!b._instance)throw new Error("Sentry has not been initialized");return b._instance}log(...e){this.debug&&console.log(...e)}get scope(){return this._scope}static get scope(){return b.instance.scope}withScope(e){let t=this._scope.child();e(t)}static withScope(e){b.instance.withScope(e)}captureException(e,t){this.captureEvent({type:"exception",level:"error",error:$t(e),scope:t??this._scope})}static captureException(e,t){b.instance.captureException(e,t)}captureMessage(e,t="info",r){this.captureEvent({type:"message",level:t,message:e,scope:r??this._scope})}static captureMessage(e,t="info",r){b.instance.captureMessage(e,t,r)}captureEvent(e){if(Math.random()>=this.sampleRate){this.log("Dropped event due to sample rate");return}if(this.shouldBuffer){if(this.buffer.length>=this.bufferlimit)return;this.buffer.push(e)}else this.sendEvent(e)}sendEvent(e,t=5e3){return M(this,null,function*(){try{this.log("Sending sentry event",e);let r=Bt(e,this.environment,this.release),n={event_id:r.event_id,dsn:this.dsn},c={type:"event"},i=JSON.stringify(n)+`
`+JSON.stringify(c)+`
`+JSON.stringify(r),l=yield Wt(this.apiURL,{method:"POST",headers:{"Content-Type":"application/x-sentry-envelope"},body:i},t);this.log("Sentry response",l.status),l.status!==200&&(console.log(l.body),console.error("Failed to send event to Sentry",l))}catch(r){console.error("Failed to send event",r)}})}flush(e=5e3){return M(this,null,function*(){try{this.log("Flushing sentry events",this.buffer.length);let t=this.buffer.splice(0,this.buffer.length).map(r=>this.sendEvent(r,e));yield Promise.all(t),this.log("Flushed all events")}catch(t){console.error("Failed to flush events",t)}})}static flush(e=5e3){return b.instance.flush(e)}static reset(){b._instance=void 0}},x(b,"_instance"),b),Ut="https://d233059272824702afc8c43834c4912d@sentry.hcaptcha.com/6",Dt="2.3.0",Vt="production";function zt(e=!0){if(!e)return Ae();me.init({dsn:Ut,release:Dt,environment:Vt});let t=me.scope;return Ct(t),Ae(t)}function Ae(e=null){return{addBreadcrumb:t=>{e&&e.addBreadcrumb(t)},captureRequest:t=>{e&&e.setRequest(t)},captureException:t=>{e&&me.captureException(t,e)}}}function Qt({scriptLocation:e,query:t,loadAsync:r=!0,crossOrigin:n="anonymous",apihost:c="https://js.hcaptcha.com",cleanup:i=!1,secureApi:l=!1,scriptSource:h=""}={},u){let d=$e(e),v=Be(d);return new Promise((k,_)=>{let g=v.document.createElement("script");g.id=wt,h?g.src=`${h}?onload=${Z}`:l?g.src=`${c}/1/secure-api.js?onload=${Z}`:g.src=`${c}/1/api.js?onload=${Z}`,g.crossOrigin=n,g.async=r;let T=(E,te)=>{try{!l&&i&&d.removeChild(g),te(E)}catch(V){_(V)}};g.onload=E=>T(E,k),g.onerror=E=>{u&&u(g.src),T(E,_)},g.src+=t!==""?`&${t}`:"",d.appendChild(g)})}var Y=[];function Ht(e={cleanup:!1},t){try{t.addBreadcrumb({category:L,message:"hCaptcha loader params",data:e});let r=$e(e.scriptLocation),n=Be(r),c=Y.find(({scope:l})=>l===n.window);if(c)return t.addBreadcrumb({category:L,message:"hCaptcha already loaded"}),c.promise;let i=new Promise((l,h)=>M(this,null,function*(){try{n.window[Z]=()=>{t.addBreadcrumb({category:L,message:"hCaptcha script called onload function"}),l(n.window.hcaptcha)};let u=jt({custom:e.custom,render:e.render,sentry:e.sentry,assethost:e.assethost,imghost:e.imghost,reportapi:e.reportapi,endpoint:e.endpoint,host:e.host,recaptchacompat:e.recaptchacompat,hl:e.hl,uj:e.uj});yield Qt(j({query:u},e),d=>{t.captureRequest({url:d,method:"GET"})}),t.addBreadcrumb({category:L,message:"hCaptcha loaded",data:c})}catch{t.addBreadcrumb({category:L,message:"hCaptcha failed to load"});let d=Y.findIndex(v=>v.scope===n.window);d!==-1&&Y.splice(d,1),h(new Error(Le))}}));return Y.push({promise:i,scope:n.window}),i}catch(r){return t.captureException(r),Promise.reject(new Error(Le))}}function Ue(e,t,r=0){return M(this,null,function*(){var n,c;let i=(n=e.maxRetries)!=null?n:2,l=(c=e.retryDelay)!=null?c:1e3,h=r<i?"Retry loading hCaptcha Api":"Exceeded maximum retries";try{return yield Ht(e,t)}catch(u){return t.addBreadcrumb({category:L,message:h}),r>=i?(t.captureException(u),Promise.reject(u)):(t.addBreadcrumb({category:L,message:`Waiting ${l}ms before retry attempt ${r+1}`}),yield Et(l),r+=1,Ue(e,t,r))}})}function Gt(){return M(this,arguments,function*(e={}){let t=zt(e.sentry);return yield Ue(e,t)})}function qe(e){let t=e&&e.ownerDocument||document,r=t.defaultView||t.parentWindow||window;return{document:t,window:r}}function Te(e){return e||document.head}var Jt=class extends p.Component{constructor(e){super(e),this._hcaptcha=void 0,this.renderCaptcha=this.renderCaptcha.bind(this),this.resetCaptcha=this.resetCaptcha.bind(this),this.removeCaptcha=this.removeCaptcha.bind(this),this.isReady=this.isReady.bind(this),this._onReady=null,this.loadCaptcha=this.loadCaptcha.bind(this),this.handleOnLoad=this.handleOnLoad.bind(this),this.handleSubmit=this.handleSubmit.bind(this),this.handleExpire=this.handleExpire.bind(this),this.handleError=this.handleError.bind(this),this.handleOpen=this.handleOpen.bind(this),this.handleClose=this.handleClose.bind(this),this.handleChallengeExpired=this.handleChallengeExpired.bind(this),this.ref=p.createRef(),this.apiScriptRequested=!1,this.sentryHub=null,this.captchaId="",this._pendingExecute=null,this.state={isApiReady:!1,isRemoved:!1,elementId:e.id}}componentDidMount(){let e=Te(this.props.scriptLocation),t=qe(e);if(this._hcaptcha=t.window.hcaptcha||void 0,typeof this._hcaptcha<"u"){this.setState({isApiReady:!0},()=>{this.renderCaptcha()});return}this.loadCaptcha()}componentWillUnmount(){let e=this._hcaptcha,t=this.captchaId;if(this._cancelPendingExecute("react-component-unmounted"),!!this.isReady())try{e.reset(t),e.remove(t)}catch{}finally{this.captchaId="",this._onReady=null}}shouldComponentUpdate(e,t){return!(this.state.isApiReady!==t.isApiReady||this.state.isRemoved!==t.isRemoved)}componentDidUpdate(e){["sitekey","size","theme","tabindex","languageOverride","endpoint"].every(t=>e[t]===this.props[t])||this.removeCaptcha(()=>{this.renderCaptcha()})}loadCaptcha(){if(this.apiScriptRequested)return;let{apihost:e,assethost:t,endpoint:r,host:n,imghost:c,languageOverride:i,reCaptchaCompat:l,reportapi:h,sentry:u,custom:d,loadAsync:v,scriptLocation:k,scriptSource:_,secureApi:g,cleanup:T=!0,userJourneys:E}=this.props;Gt({render:"explicit",apihost:e,assethost:t,endpoint:r,hl:i,host:n,imghost:c,recaptchacompat:l===!1?"off":null,reportapi:h,sentry:u,custom:d,loadAsync:v,scriptLocation:k,scriptSource:_,secureApi:g,cleanup:T,uj:E!==void 0?E:!1}).then(this.handleOnLoad,this.handleError).catch(this.handleError),this.apiScriptRequested=!0}renderCaptcha(e){let{onReady:t}=this.props,{isApiReady:r}=this.state,n=this.captchaId;if(!r||n)return;let c=Object.assign({"open-callback":this.handleOpen,"close-callback":this.handleClose,"error-callback":this.handleError,"chalexpired-callback":this.handleChallengeExpired,"expired-callback":this.handleExpire,callback:this.handleSubmit},this.props,{hl:this.props.hl||this.props.languageOverride,languageOverride:void 0}),i=this._hcaptcha.render(this.ref.current,c);this.captchaId=i,this.setState({isRemoved:!1},()=>{e&&e(),t&&t(),this._onReady&&this._onReady(i)})}resetCaptcha(){let e=this._hcaptcha,t=this.captchaId;this.isReady()&&(e.reset(t),this._cancelPendingExecute("hcaptcha-reset"))}removeCaptcha(e){let t=this._hcaptcha,r=this.captchaId;this._cancelPendingExecute("hcaptcha-removed"),this.isReady()&&this.setState({isRemoved:!0},()=>{this.captchaId="",t.remove(r),e&&e()})}handleOnLoad(){this.setState({isApiReady:!0},()=>{let e=Te(this.props.scriptLocation),t=qe(e);this._hcaptcha=t.window.hcaptcha,this.renderCaptcha(()=>{let{onLoad:r}=this.props;r&&r()})})}handleSubmit(e){let{onVerify:t}=this.props,{isRemoved:r}=this.state,n=this._hcaptcha,c=this.captchaId;if(typeof n>"u"||r)return;let i=n.getResponse(c),l=n.getRespKey(c);t&&t(i,l)}handleExpire(){let{onExpire:e}=this.props,t=this._hcaptcha,r=this.captchaId;this.isReady()&&(t.reset(r),e&&e())}handleError(e){let{onError:t}=this.props,r=this._hcaptcha,n=this.captchaId;this.isReady()&&r.reset(n),t&&t(e)}isReady(){let{isApiReady:e,isRemoved:t}=this.state;return e&&!t}_cancelPendingExecute(e){if(!this._pendingExecute)return;let t=this._pendingExecute;this._pendingExecute=null;let r=new Error(e);t.reject(r)}handleOpen(){!this.isReady()||!this.props.onOpen||this.props.onOpen()}handleClose(){!this.isReady()||!this.props.onClose||this.props.onClose()}handleChallengeExpired(){!this.isReady()||!this.props.onChalExpired||this.props.onChalExpired()}execute(e=null){e=typeof e=="object"?e:null;try{let t=this._hcaptcha,r=this.captchaId;if(e&&e.async&&this._pendingExecute&&this._cancelPendingExecute("hcaptcha-execute-replaced"),!this.isReady())return e&&e.async?new Promise((c,i)=>{this._pendingExecute={resolve:c,reject:i},this._onReady=l=>{if(this._pendingExecute)try{let h=t.execute(l,e);h&&typeof h.then=="function"?h.then(u=>{this._pendingExecute=null,c(u)}).catch(u=>{this._pendingExecute=null,i(u)}):(this._pendingExecute=null,i(new Error("hcaptcha-execute-no-promise")))}catch(h){this._pendingExecute=null,i(h)}}}):(this._onReady=c=>{t.execute(c,e)},null);let n=t.execute(r,e);return e&&e.async&&n&&typeof n.then=="function"?new Promise((c,i)=>{this._pendingExecute={resolve:c,reject:i},n.then(l=>{this._pendingExecute=null,c(l)}).catch(l=>{this._pendingExecute=null,i(l)})}):n}catch(t){return e&&e.async?Promise.reject(t):null}}close(){let e=this._hcaptcha,t=this.captchaId;if(this._cancelPendingExecute("hcaptcha-closed"),!!this.isReady())return e.close(t)}setData(e){let t=this._hcaptcha,r=this.captchaId;this.isReady()&&(e&&typeof e!="object"&&(e=null),t.setData(r,e))}getResponse(){return this._hcaptcha.getResponse(this.captchaId)}getRespKey(){return this._hcaptcha.getRespKey(this.captchaId)}render(){let{elementId:e}=this.state;return p.createElement("div",{ref:this.ref,id:e})}};p.createContext();var Kt=Jt;const Xt="905871526482-4i8pfv8435p4eq10226j0agks7j007ag.apps.googleusercontent.com",Yt="93726ad0-1700-48aa-8aa6-77825d4cfbee";function ss({initialMode:e="login",onClose:t=null,compact:r=!1}){const[n,c]=p.useState(e),[i,l]=p.useState(""),[h,u]=p.useState(""),[d,v]=p.useState(""),[k,_]=p.useState(!1),[g,T]=p.useState(!1),[E,te]=p.useState(""),[V,De]=p.useState(""),[fe,Ve]=p.useState(""),[ge,ze]=p.useState(""),[xe,Qe]=p.useState(""),[P,He]=p.useState(!1),[se]=p.useState(()=>{const o=document.cookie.match(/spark_ref=([^;]+)/);return o?o[1]:""}),[ve,f]=p.useState(""),[R,w]=p.useState(!1),{login:Ge,register:Je,googleLogin:z,checkCaptchaRequired:Ke,pendingVerification:B,verifyEmail:Xe,resendCode:Ye,cancelVerification:Ze}=pt(),re=p.useRef(null),ne=p.useRef(""),[S,O]=p.useState(""),[ae,Q]=p.useState(!1),N=p.useRef(null),[ie,ye]=p.useState(null),[C,oe]=p.useState(0),[A,H]=p.useState(null),[et,ce]=p.useState(!1),[$,be]=p.useState(""),[le,we]=p.useState(!1),[je,G]=p.useState(""),[Ce,I]=p.useState(""),[W,ke]=p.useState(""),[q,J]=p.useState(0),[Ee,F]=p.useState(""),[he,Re]=p.useState(!1),[Ne,K]=p.useState(""),{t:a}=mt();p.useEffect(()=>{ne.current=se},[se]),p.useEffect(()=>{Q(n==="signup"),O(""),ce(!1),G(""),I(""),N.current&&N.current.resetCaptcha()},[n]);const tt=o=>O(o),st=()=>O(""),rt=()=>{O(""),f(a("auth.captchaFailed"))};p.useEffect(()=>{if(q>0){const o=setTimeout(()=>J(q-1),1e3);return()=>clearTimeout(o)}},[q]),p.useEffect(()=>{if(C>0){const o=setTimeout(()=>oe(C-1),1e3);return()=>clearTimeout(o)}},[C]);const nt=o=>{const m=Math.floor(o/3600),D=Math.floor(o%3600/60),ue=o%60;return m>0?`${m}h ${D}m ${ue}s`:D>0?`${D}m ${ue}s`:`${ue}s`},Se=p.useCallback(async o=>{if(!o.credential)return;if(n==="signup"&&!P){f(a("auth.termsRequired"));return}w(!0),f("");const m=await z(o.credential,ne.current,S,P);if(m.success){w(!1),O(""),N.current&&N.current.resetCaptcha();return}if(m.error&&m.error.toLowerCase().includes("terms")){f(a("auth.termsRequired")),w(!1);return}if(m.error&&m.error.toLowerCase().includes("captcha")){ye(o.credential),Q(!0),f(a("auth.newAccountCaptcha")),w(!1);return}f(m.error||a("auth.googleLoginFailed")),w(!1),O(""),N.current&&N.current.resetCaptcha()},[z,S,a,n,P]);p.useEffect(()=>{ie&&S&&(async()=>{w(!0),f("");const o=await z(ie,ne.current,S,P);o.success||f(o.error||a("auth.googleLoginFailed")),w(!1),ye(null),O(""),N.current&&N.current.resetCaptcha()})()},[ie,S,z,a]),p.useEffect(()=>{const o=()=>{window.google?.accounts?.id&&re.current&&(window.google.accounts.id.initialize({client_id:Xt,callback:Se}),window.google.accounts.id.renderButton(re.current,{theme:"filled_black",size:"large",width:320,text:"continue_with",shape:"rectangular"}))};if(window.google?.accounts?.id)o();else{const m=setInterval(()=>{window.google?.accounts?.id&&(clearInterval(m),o())},200);return()=>clearInterval(m)}},[Se]);const at=async o=>{if(o.preventDefault(),f(""),!i.trim()||!h.trim()){f(a("auth.emailRequired"));return}if(n==="signup"&&!S){f(a("auth.captchaRequired"));return}if(n==="login"&&ae&&!S){f(a("auth.captchaRequired"));return}if(n==="signup"){if(!P){f(a("auth.termsRequired"));return}if(h!==d){f(a("auth.passwordsNoMatch"));return}if(!Oe(h).every(D=>D.met)){f(a("auth.meetRequirements"));return}}w(!0);try{let m;if(n==="login"){if(m=await Ge(i,h,S),m.account_locked){oe(m.remaining_seconds||86400),H(0),f(""),w(!1);return}if(m.captcha_required){Q(!0),f(a("auth.proveHuman")),m.attempts_remaining!==void 0&&H(m.attempts_remaining),w(!1);return}if(m.requires_verification){J(60),w(!1);return}!m.success&&m.attempts_remaining!==void 0&&H(m.attempts_remaining)}else if(m=await Je(i,h,"",se,S,{full_name:E.trim()||void 0,date_of_birth:V||void 0,security_question:fe||void 0,security_answer:ge.trim()||void 0,country:xe||void 0,terms_accepted:!0}),m.requires_verification){J(60),w(!1);return}m.success?(H(null),oe(0)):(f(m.error||a("auth.somethingWrong")),O(""),N.current&&N.current.resetCaptcha())}catch(m){f(m.message||a("auth.connectionError"))}w(!1)},it=async()=>{n==="login"&&i.trim()&&i.includes("@")&&await Ke(i)&&Q(!0)},_e=()=>{ce(!0),be(i||""),G(""),I("")},ot=async o=>{we(!0),I(""),G("");try{(await ft.post("/api/user/forgot-password",{email:o})).data.success&&G(a("auth.resetLinkSent",{email:o}))}catch(m){m.response?.status===423?I(a("auth.accountLocked423")):I(m.response?.data?.detail||a("auth.failedSendReset"))}we(!1)},ct=async()=>{if(!$.trim()||!$.includes("@")){I(a("auth.enterValidEmail"));return}await ot($)},lt=async o=>{if(o.preventDefault(),!W.trim()||W.length!==6){F(a("auth.enterDigitCode"));return}Re(!0),F(""),K("");const m=await Xe(B.email,W);m.success||F(m.error),Re(!1)},ht=async()=>{if(q>0)return;K(""),F("");const o=await Ye(B.email);o.success?(K(o.message||"New code sent!"),J(60)):F(o.error)},dt=()=>{Ze(),ke(""),F(""),K(""),c("login")},Oe=o=>[{label:a("auth.pwdReq1"),met:o.length>=8},{label:a("auth.pwdReq2"),met:(o.match(/[A-Z]/g)||[]).length>=2},{label:a("auth.pwdReq3"),met:(o.match(/[a-z]/g)||[]).length>=2},{label:a("auth.pwdReq4"),met:(o.match(/[0-9]/g)||[]).length>=2},{label:a("auth.pwdReq5"),met:(o.match(/[^A-Za-z0-9]/g)||[]).length>=2}],de=Oe(h),U=de.filter(o=>o.met).length/de.length*100,ut=U<=20?"#ef4444":U<=40?"#f97316":U<=60?"#eab308":U<=80?"#22c55e":"#10b981";return B?s.jsxs("div",{className:"auth-form-wrapper",children:[!r&&s.jsxs("div",{className:"access-gate-header",children:[s.jsx("div",{className:"gate-logo",children:s.jsx("span",{className:"gate-icon",children:"✉"})}),s.jsx("h1",{children:a("auth.verifyEmail")}),s.jsxs("p",{className:"gate-subtitle",children:[a("auth.codeSentTo")," ",s.jsx("strong",{style:{color:"#3b82f6"},children:B.email})]})]}),r&&s.jsxs("div",{className:"auth-form-compact-header",children:[s.jsx("h2",{children:a("auth.verifyEmail")}),s.jsxs("p",{className:"gate-subtitle",children:[a("auth.codeSentToCompact")," ",s.jsx("strong",{style:{color:"#3b82f6"},children:B.email})]})]}),s.jsxs("form",{className:"access-form",onSubmit:lt,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"verify-code",children:a("auth.verificationCode")}),s.jsx("input",{id:"verify-code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,value:W,onChange:o=>{const m=o.target.value.replace(/\D/g,"");ke(m)},placeholder:"000000",autoFocus:!0,disabled:he,className:"verification-code-input"})]}),Ee&&s.jsx("div",{className:"gate-error",children:Ee}),Ne&&s.jsx("div",{className:"gate-success",children:Ne}),s.jsx("button",{type:"submit",className:"gate-submit-btn",disabled:he||W.length!==6,children:a(he?"auth.verifying":"auth.verifyEmailBtn")})]}),s.jsxs("div",{className:"verify-actions",children:[s.jsx("button",{className:"resend-btn",onClick:ht,disabled:q>0,children:q>0?a("auth.resendCodeIn",{seconds:q}):a("auth.resendCode")}),s.jsx("button",{className:"link-btn",onClick:dt,children:a("auth.backToLogin")})]}),s.jsx("div",{className:"verify-help",children:s.jsx("p",{children:a("auth.checkSpam")})})]}):s.jsxs("div",{className:"auth-form-wrapper",children:[!r&&s.jsxs("div",{className:"access-gate-header",children:[s.jsx("div",{className:"gate-logo",children:s.jsx("span",{className:"gate-icon",children:"⚽"})}),s.jsx("h1",{children:a("auth.sparkAIPrediction")}),s.jsx("p",{className:"gate-subtitle",children:a("auth.smartAnalysis")})]}),r&&t&&s.jsxs("div",{className:"auth-form-compact-header",children:[s.jsx("h2",{children:a(n==="login"?"auth.welcomeBack":"auth.createAccountTitle")}),s.jsx("button",{className:"auth-modal-close",onClick:t,"aria-label":"Close",children:"×"})]}),et?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"forgot-password-screen",children:[s.jsx("div",{className:"forgot-password-icon",children:s.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),s.jsx("h2",{className:"forgot-password-title",children:a("auth.resetPassword")}),s.jsx("p",{className:"forgot-password-label",children:a("auth.resetPasswordLabel")}),s.jsxs("div",{className:"forgot-password-input-row",children:[s.jsx("input",{type:"email",value:$,onChange:o=>be(o.target.value),placeholder:a("auth.emailPlaceholder"),disabled:le,autoFocus:!0}),s.jsx("button",{type:"button",className:"forgot-send-btn",onClick:ct,disabled:le||!$.trim(),children:a(le?"auth.sending":"auth.send")})]}),je&&s.jsx("div",{className:"forgot-success",children:je}),Ce&&s.jsx("div",{className:"gate-error",style:{marginTop:"10px"},children:Ce})]}),s.jsx("div",{className:"gate-footer",children:s.jsx("p",{children:s.jsx("button",{className:"link-btn",onClick:()=>ce(!1),children:a("auth.rememberPassword")})})})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"auth-mode-toggle",children:[s.jsx("button",{className:`mode-btn ${n==="login"?"active":""}`,onClick:()=>{c("login"),f("")},children:a("auth.login")}),s.jsx("button",{className:`mode-btn ${n==="signup"?"active":""}`,onClick:()=>{c("signup"),f("")},children:a("auth.signup")})]}),s.jsx("div",{className:"google-signin-section",children:s.jsx("div",{ref:re,className:"google-btn-wrapper"})}),s.jsx("div",{className:"auth-divider",children:s.jsx("span",{children:a("common.or")})}),s.jsxs("form",{className:"access-form",onSubmit:at,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"email",children:a("auth.email")}),s.jsx("input",{id:"email",type:"email",value:i,onChange:o=>l(o.target.value),placeholder:a("auth.emailPlaceholder"),autoFocus:!0,disabled:R||C>0,onBlur:it})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"password",children:a("auth.password")}),s.jsxs("div",{className:"password-input-wrapper",children:[s.jsx("input",{id:"password",type:k?"text":"password",value:h,onChange:o=>u(o.target.value),placeholder:a(n==="signup"?"auth.createStrongPassword":"auth.enterPassword"),disabled:R||C>0}),s.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>_(!k),tabIndex:-1,children:k?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),s.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),s.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),n==="login"&&C===0&&s.jsx("div",{className:"forgot-password-link",children:s.jsx("button",{type:"button",className:"link-btn",onClick:_e,children:a("auth.forgotPassword")})}),n==="signup"&&h.length>0&&s.jsxs("div",{className:"password-requirements",children:[s.jsx("div",{className:"password-strength-bar",children:s.jsx("div",{className:"password-strength-fill",style:{width:`${U}%`,background:ut}})}),s.jsx("ul",{className:"password-req-list",children:de.map((o,m)=>s.jsxs("li",{className:o.met?"req-met":"req-unmet",children:[s.jsx("span",{className:"req-icon",children:o.met?"✓":"✗"}),o.label]},m))})]}),n==="signup"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"confirm-password",children:a("auth.confirmPassword")}),s.jsxs("div",{className:"password-input-wrapper",children:[s.jsx("input",{id:"confirm-password",type:g?"text":"password",value:d,onChange:o=>v(o.target.value),placeholder:a("auth.repeatPassword"),disabled:R}),s.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>T(!g),tabIndex:-1,children:g?s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),s.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),s.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):s.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),s.jsxs("div",{className:"signup-personal-section",children:[s.jsx("p",{className:"signup-personal-label",children:a("auth.personalInfo")}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"full-name",children:a("auth.fullName")}),s.jsx("input",{id:"full-name",type:"text",value:E,onChange:o=>te(o.target.value),placeholder:a("auth.enterFullName"),maxLength:100,disabled:R})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Country"}),s.jsx(gt,{value:xe,onChange:Qe,disabled:R,placeholder:"Search for your country"})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"date-of-birth",children:a("auth.dateOfBirth")}),s.jsx("input",{id:"date-of-birth",type:"date",value:V,onChange:o=>De(o.target.value),disabled:R})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"security-question",children:a("auth.securityQuestion")}),s.jsxs("select",{id:"security-question",value:fe,onChange:o=>Ve(o.target.value),disabled:R,children:[s.jsx("option",{value:"",children:a("auth.selectSecurityQuestion")}),s.jsx("option",{value:"What is your mother's maiden name?",children:a("auth.secQ1")}),s.jsx("option",{value:"What was your first pet's name?",children:a("auth.secQ2")}),s.jsx("option",{value:"What city were you born in?",children:a("auth.secQ3")}),s.jsx("option",{value:"What is your favorite movie?",children:a("auth.secQ4")}),s.jsx("option",{value:"What was the name of your first school?",children:a("auth.secQ5")}),s.jsx("option",{value:"What is your childhood nickname?",children:a("auth.secQ6")})]})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"security-answer",children:a("auth.securityAnswer")}),s.jsx("input",{id:"security-answer",type:"text",value:ge,onChange:o=>ze(o.target.value),placeholder:a("auth.enterYourAnswer"),maxLength:200,disabled:R})]})]})]}),n==="signup"&&s.jsx("div",{className:"terms-checkbox-section",children:s.jsxs("label",{className:"terms-checkbox-label",children:[s.jsx("input",{type:"checkbox",checked:P,onChange:o=>He(o.target.checked),disabled:R}),s.jsxs("span",{children:[a("auth.agreeToTerms")," ",s.jsx("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"terms-link",children:a("auth.termsOfService")})]})]})}),(ae||n==="signup")&&s.jsx("div",{className:"captcha-container",children:s.jsx(Kt,{ref:N,sitekey:Yt,onVerify:tt,onExpire:st,onError:rt,theme:"dark",size:"normal"})}),ve&&s.jsx("div",{className:"gate-error",children:ve}),n==="login"&&A!==null&&A>0&&C===0&&s.jsx("div",{className:"gate-warning",children:A===1?a("auth.warningLastAttempt"):a("auth.attemptsRemaining",{count:A})}),n==="login"&&A!==null&&A<=2&&A>0&&C===0&&s.jsxs("div",{className:"forgot-password-prompt",children:[s.jsxs("span",{children:[a("auth.forgottenPassword")," "]}),s.jsx("button",{type:"button",className:"link-btn forgot-prompt-link",onClick:_e,children:a("auth.clickToReset")})]}),C>0&&s.jsxs("div",{className:"gate-lockout",children:[s.jsx("div",{className:"lockout-icon",children:s.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),s.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}),s.jsx("p",{className:"lockout-title",children:a("auth.accountTempLocked")}),s.jsx("p",{className:"lockout-message",children:a("auth.tooManyAttempts")}),s.jsx("div",{className:"lockout-timer",children:nt(C)}),s.jsx("p",{className:"lockout-reset-hint",children:a("auth.lockoutResetHint")})]}),s.jsx("button",{type:"submit",className:"gate-submit-btn",disabled:R||C>0||(ae||n==="signup")&&!S||n==="signup"&&!P,children:R?a(n==="login"?"auth.loggingIn":"auth.creatingAccount"):C>0?a("auth.accountLocked"):a(n==="login"?"auth.login":"auth.createAccount")})]}),s.jsx("div",{className:"gate-footer",children:n==="login"?s.jsxs("p",{children:[a("auth.noAccount")," ",s.jsx("button",{className:"link-btn",onClick:()=>c("signup"),children:a("auth.signUpFree")})]}):s.jsxs("p",{children:[a("auth.haveAccount")," ",s.jsx("button",{className:"link-btn",onClick:()=>c("login"),children:a("auth.logIn")})]})})]})]})}export{ss as A};
