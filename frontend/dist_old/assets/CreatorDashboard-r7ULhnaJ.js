import{u as be,r as l,j as e,c}from"./index-B3SC9TNl.js";function _e(){const{t}=be(),[z,Z]=l.useState(null),[ee,se]=l.useState(!0),[ae,N]=l.useState(!1),[_,E]=l.useState(""),[P,te]=l.useState(localStorage.getItem("mpesa_phone")||""),[y,I]=l.useState("mpesa"),[u,ie]=l.useState(!1),[D,k]=l.useState(!1),[S,m]=l.useState(null),[L,le]=l.useState([]),[d,re]=l.useState(()=>localStorage.getItem("earnings_hidden")==="true"),[h,g]=l.useState("analytics"),[W,ne]=l.useState({total_earned:0,earnings:[]}),V=l.useRef(null),[v,de]=l.useState([]),[oe,T]=l.useState(!1),[H,$]=l.useState(null),[O,U]=l.useState(""),[K,C]=l.useState(!1),[F,q]=l.useState(""),[ce,he]=l.useState(""),[p,x]=l.useState(!1),[B,r]=l.useState({type:"",text:""}),[o,Y]=l.useState(null),[G,X]=l.useState(!1),M=async()=>{try{const[s,i,w,b]=await Promise.all([c.get("/api/creator/dashboard"),c.get("/api/withdrawal/history"),c.get("/api/user/referral-earnings").catch(()=>({data:{total_earned:0,earnings:[]}})),c.get("/api/withdrawal/whop-available").catch(()=>({data:{available:!1}}))]);Z(s.data),le(i.data.withdrawals||[]),ne(w.data),ie(b.data.available)}catch{}se(!1)};l.useEffect(()=>(M(),V.current=setInterval(M,3e4),()=>clearInterval(V.current)),[]);const xe=async()=>{const s=parseFloat(_);if(!(!s||s<5))if(y==="mpesa"){const i=P.replace(/[^0-9]/g,""),w=i.startsWith("0")?"254"+i.slice(1):i;if(!/^254[17]\d{8}$/.test(w)){m({error:"Enter a valid M-Pesa number"});return}k(!0),m(null);try{const b=await c.post("/api/withdrawal/request",{amount_usd:s,phone:w,withdrawal_method:"mpesa"});m({success:!0,message:b.data.message}),localStorage.setItem("mpesa_phone",P),M()}catch(b){m({error:b.response?.data?.detail||"Withdrawal failed"})}k(!1)}else{k(!0),m(null);try{const i=await c.post("/api/withdrawal/request",{amount_usd:s,withdrawal_method:"whop"});m({success:!0,message:i.data.message}),M()}catch(i){m({error:i.response?.data?.detail||"Withdrawal failed"})}k(!1)}},pe=()=>{const s=!d;re(s),localStorage.setItem("earnings_hidden",s?"true":"false")},f=async()=>{T(!0);try{const s=await c.get("/api/withdrawal/options");de(s.data.options||[])}catch{}T(!1)},J=async s=>{if(r({type:"",text:""}),s==="mpesa")$("mpesa"),U(""),C(!1),q("");else{x(!0);try{const i=await c.post("/api/withdrawal/options/add",{method:"whop"});i.data.success?(r({type:"success",text:"Whop withdrawal method linked and added successfully!"}),f()):r({type:"error",text:i.data.error||"Failed to add Whop method."})}catch(i){r({type:"error",text:i.response?.data?.detail||"Failed to add Whop method."})}x(!1)}},me=async()=>{const s=O.replace(/[^0-9]/g,"");if(!s||s.length<9){r({type:"error",text:"Enter a valid phone number."});return}x(!0),r({type:"",text:""});try{const i=await c.post("/api/withdrawal/options/add",{method:"mpesa",mpesa_phone:s});i.data.success||i.data.otp_sent?(C(!0),he(s),r({type:"success",text:"Verification code sent to your associated email. Enter the 6-digit code below."})):r({type:"error",text:i.data.error||"Failed to send OTP."})}catch(i){r({type:"error",text:i.response?.data?.detail||"Failed to send OTP."})}x(!1)},ye=async()=>{if(!F||F.length!==6){r({type:"error",text:"Enter the 6-digit code."});return}x(!0),r({type:"",text:""});try{const s=await c.post("/api/withdrawal/options/verify-phone",{phone:ce,code:F});s.data.success?(r({type:"success",text:"Phone verified! M-Pesa withdrawal method is now active."}),$(null),C(!1),f()):r({type:"error",text:s.data.error||"Verification failed."})}catch(s){r({type:"error",text:s.response?.data?.detail||"Verification failed."})}x(!1)},ue=async s=>{if(confirm(`Remove ${s==="mpesa"?"M-Pesa":"Whop"} withdrawal method? A 48-hour cooldown will apply before you can add a new one.`)){x(!0),r({type:"",text:""});try{await c.delete(`/api/withdrawal/options/${s}`),r({type:"success",text:"Withdrawal method removed."}),f()}catch(i){r({type:"error",text:i.response?.data?.detail||"Failed to remove."})}x(!1)}},je=async s=>{x(!0);try{await c.put("/api/withdrawal/options/primary",{method:s}),r({type:"success",text:`${s==="mpesa"?"M-Pesa":"Whop"} set as primary.`}),f()}catch(i){r({type:"error",text:i.response?.data?.detail||"Failed to set primary."})}x(!1)},we=async(s,i)=>{if(!(!s||s<5)){X(!0);try{const w=await c.post("/api/withdrawal/fee-preview",{amount_usd:parseFloat(s),method:i});Y(w.data)}catch{Y(null)}X(!1)}};if(ee)return e.jsx("div",{className:"creator-page",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:t("common.loading")})]})});if(!z)return e.jsx("div",{className:"creator-page",children:e.jsxs("div",{className:"creator-empty",children:[e.jsx("h2",{children:t("creator.dashboard")}),e.jsx("p",{children:"Start selling predictions to see your earnings here."})]})});const{wallet:n,all_predictions:ge,paid_predictions:ve,recent_sales:A,referral_stats:Q,analytics_summary:fe}=z,R=ge||ve||[],j=fe||{};return e.jsxs("div",{className:"creator-page",children:[e.jsxs("div",{className:"creator-header",children:[e.jsx("h2",{children:t("creator.dashboard")}),e.jsxs("div",{className:"creator-header-actions",children:[e.jsx("p",{className:"creator-subtitle",children:"Track your prediction sales and earnings"}),e.jsx("button",{className:"creator-privacy-btn",onClick:pe,title:t(d?"creator.showRevenue":"creator.hideRevenue"),children:d?e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94"}),e.jsx("path",{d:"M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19"}),e.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),e.jsxs("div",{className:"creator-tab-bar",style:a.tabBar,children:[e.jsxs("button",{style:{...a.tab,...h==="analytics"?a.tabActive:{}},onClick:()=>g("analytics"),children:[t("creator.predictionAnalytics")," (",R.length,")"]}),e.jsxs("button",{style:{...a.tab,...h==="sales"?a.tabActive:{}},onClick:()=>g("sales"),children:[t("creator.recentSales")," (",A.length,")"]}),e.jsxs("button",{style:{...a.tab,...h==="withdrawals"?a.tabActive:{}},onClick:()=>g("withdrawals"),children:[t("creator.withdrawals")," (",L.length,")"]}),e.jsx("button",{style:{...a.tab,...h==="methods"?a.tabActive:{}},onClick:()=>{g("methods"),f()},children:"Withdrawal Methods"}),e.jsxs("button",{style:{...a.tab,...h==="referrals"?a.tabActive:{}},onClick:()=>g("referrals"),children:[t("creator.referralEarnings")," (",W.earnings.length,")"]})]}),h==="analytics"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"creator-section",children:[e.jsx("h3",{children:t("creator.analytics")}),e.jsxs("div",{style:a.analyticsGrid,children:[e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#3b82f6",strokeWidth:"2",children:[e.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),e.jsx("div",{style:a.analyticsValue,children:(j.total_views||0).toLocaleString()}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.totalImpressions")})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#8b5cf6",strokeWidth:"2",children:[e.jsx("path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"}),e.jsx("polyline",{points:"10 17 15 12 10 7"}),e.jsx("line",{x1:"15",y1:"12",x2:"3",y2:"12"})]})}),e.jsx("div",{style:a.analyticsValue,children:(j.total_clicks||0).toLocaleString()}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.totalClicks")})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:[e.jsx("path",{d:"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3H14z"}),e.jsx("path",{d:"M7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"})]})}),e.jsx("div",{style:a.analyticsValue,children:j.total_likes||0}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.totalLikes")})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),e.jsx("div",{style:a.analyticsValue,children:j.total_comments||0}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.totalComments")})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#eab308",strokeWidth:"2",children:e.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),e.jsx("div",{style:a.analyticsValue,children:j.avg_rating_overall||0}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.avgRating")})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#06b6d4",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7"})]})}),e.jsx("div",{style:a.analyticsValue,children:j.total_predictions||0}),e.jsx("div",{style:a.analyticsLabel,children:t("creator.totalPredictions")})]})]})]}),e.jsx("div",{className:"creator-section",children:R.length===0?e.jsx("p",{className:"creator-empty-text",children:t("creator.noPredictions")}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"creator-pred-table",children:[e.jsxs("div",{style:a.tableHeader,children:[e.jsx("span",{style:{...a.col,flex:2},children:t("creator.teams")}),e.jsx("span",{style:{...a.col,flex:1},children:t("creator.pickResult")}),e.jsx("span",{style:a.colNum,children:t("creator.viewsCol")}),e.jsx("span",{style:a.colNum,children:t("creator.clicksCol")}),e.jsx("span",{style:a.colNum,children:t("creator.likesCol")}),e.jsx("span",{style:a.colNum,children:t("creator.commentsCol")}),e.jsx("span",{style:a.colNum,children:t("creator.ratingCol")}),e.jsx("span",{style:a.colNum,children:t("creator.buyersCol")}),e.jsx("span",{style:a.colNum,children:t("creator.revenueCol")})]}),R.map(s=>e.jsxs("div",{style:a.tableRow,children:[e.jsxs("span",{style:{...a.col,flex:2},children:[e.jsxs("strong",{style:{fontSize:13,color:"#e2e8f0"},children:[s.team_a_name," vs ",s.team_b_name]}),e.jsxs("span",{style:{fontSize:11,color:"#64748b",display:"block"},children:[s.competition&&`${s.competition} | `,new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs("span",{style:{...a.col,flex:1},children:[e.jsx("span",{style:{fontSize:13,color:"#e2e8f0"},children:s.predicted_result}),e.jsxs("span",{style:{display:"flex",gap:4,marginTop:2},children:[s.is_paid&&e.jsx("span",{style:a.paidBadge,children:"$"}),s.match_finished&&e.jsx("span",{style:{...a.resultBadge,background:s.result_correct?"#16a34a":"#dc2626"},children:s.result_correct?"W":"L"})]})]}),e.jsx("span",{style:a.colNum,children:s.view_count}),e.jsx("span",{style:a.colNum,children:s.click_count}),e.jsx("span",{style:a.colNum,children:s.likes}),e.jsx("span",{style:a.colNum,children:s.comment_count}),e.jsx("span",{style:a.colNum,children:s.avg_rating>0?s.avg_rating:"-"}),e.jsx("span",{style:a.colNum,children:s.is_paid?s.purchase_count:"-"}),e.jsx("span",{style:a.colNum,children:s.is_paid?d?"***":`$${s.total_revenue.toFixed(2)}`:"-"})]},s.id))]})})})]}),h==="sales"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"creator-section",children:e.jsxs("div",{style:a.analyticsGrid,children:[e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),e.jsx("div",{style:a.analyticsValue,children:d?"****":`$${n.total_earned_usd.toFixed(2)}`}),e.jsx("div",{style:a.analyticsLabel,children:"Total Revenue"})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#3b82f6",strokeWidth:"2",children:[e.jsx("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),e.jsx("line",{x1:"1",y1:"10",x2:"23",y2:"10"})]})}),e.jsx("div",{style:a.analyticsValue,children:n.total_sales}),e.jsx("div",{style:a.analyticsLabel,children:"Total Sales"})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#f59e0b",strokeWidth:"2",children:[e.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),e.jsx("path",{d:"M2 17l10 5 10-5"}),e.jsx("path",{d:"M2 12l10 5 10-5"})]})}),e.jsx("div",{style:a.analyticsValue,children:d?"****":`$${n.total_sales>0?(n.total_earned_usd/n.total_sales).toFixed(2):"0.00"}`}),e.jsx("div",{style:a.analyticsLabel,children:"Avg per Sale"})]})]})}),e.jsx("div",{className:"creator-section",children:A.length===0?e.jsx("p",{className:"creator-empty-text",children:t("creator.noSales")}):e.jsx("div",{className:"creator-sales-list",children:A.map((s,i)=>e.jsxs("div",{className:"creator-sale-row",children:[e.jsxs("span",{className:"sale-match",children:[s.team_a_name," vs ",s.team_b_name]}),e.jsx("span",{className:"sale-amount",children:d?"***":`+$${(s.price_amount*.7).toFixed(2)}`}),e.jsx("span",{className:"sale-date",children:new Date(s.created_at).toLocaleString()})]},i))})})]}),h==="withdrawals"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"creator-wallet",children:[e.jsxs("div",{className:"wallet-card main",children:[e.jsx("div",{className:"wallet-label",children:t("creator.availableBalance")}),e.jsx("div",{className:"wallet-amount",children:d?"****":`$${n.balance_usd.toFixed(2)}`}),e.jsx("button",{className:`withdraw-btn ${n.balance_usd>=5?"active":""}`,disabled:n.balance_usd<5,onClick:()=>{N(!0),m(null),E("")},children:n.balance_usd<5?"Min $5.00 to withdraw":t("creator.requestWithdrawal")})]}),e.jsxs("div",{className:"wallet-card",children:[e.jsx("div",{className:"wallet-label",children:t("creator.totalEarned")}),e.jsx("div",{className:"wallet-amount",children:d?"****":`$${n.total_earned_usd.toFixed(2)}`})]}),e.jsxs("div",{className:"wallet-card",children:[e.jsx("div",{className:"wallet-label",children:"Total Withdrawn"}),e.jsx("div",{className:"wallet-amount",children:d?"****":`$${(n.total_earned_usd-n.balance_usd).toFixed(2)}`})]})]}),e.jsxs("div",{className:"creator-section",children:[e.jsx("h3",{children:"Withdrawal History"}),L.length===0?e.jsx("p",{className:"creator-empty-text",children:"No withdrawals yet."}):e.jsx("div",{className:"withdrawal-history",children:L.map(s=>e.jsxs("div",{className:"withdrawal-item",children:[e.jsxs("div",{className:"withdrawal-item-info",children:[e.jsx("span",{className:"withdrawal-item-amount",children:d?"****":`$${s.amount_usd.toFixed(2)}`}),e.jsx("span",{className:"withdrawal-item-phone",children:s.withdrawal_method==="whop"?"Whop (USD)":`M-Pesa: ...${(s.phone_number||"").slice(-4)}`}),e.jsx("span",{className:"withdrawal-item-date",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx("span",{className:`withdrawal-status-badge ${s.status}`,children:s.status})]},s.id))})]})]}),h==="methods"&&e.jsxs("div",{className:"creator-section",children:[B.text&&e.jsx("div",{className:`wd-method-msg ${B.type}`,children:B.text}),oe?e.jsx("p",{style:{color:"#94a3b8",textAlign:"center",padding:20},children:"Loading..."}):e.jsxs(e.Fragment,{children:[v.length>0&&e.jsxs("div",{className:"wd-methods-list",children:[e.jsx("h4",{style:{margin:"0 0 12px",color:"#e2e8f0",fontSize:15},children:"Your Withdrawal Methods"}),v.map((s,i)=>e.jsxs("div",{className:"wd-method-card",children:[e.jsxs("div",{className:"wd-method-info",children:[e.jsxs("div",{className:"wd-method-name",children:[e.jsx("span",{className:`wd-method-badge ${s.method}`,children:s.method==="mpesa"?"M-Pesa (KES)":"Whop (USD)"}),s.is_primary&&e.jsx("span",{className:"wd-primary-badge",children:"Primary"})]}),e.jsxs("div",{className:"wd-method-detail",children:[s.method==="mpesa"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:["Phone: ",s.mpesa_phone_masked||"---"]}),s.mpesa_phone_verified?e.jsx("span",{className:"wd-verified",children:"Verified"}):e.jsx("span",{className:"wd-unverified",children:"Unverified"})]}),s.method==="whop"&&e.jsx("span",{children:s.whop_linked?"Account linked":"Not linked"})]}),s.cooldown_active&&e.jsxs("div",{className:"wd-cooldown",children:["Cooldown: ",s.cooldown_remaining_hours,"h remaining"]})]}),e.jsxs("div",{className:"wd-method-actions",children:[!s.is_primary&&s.is_active&&!s.cooldown_active&&e.jsx("button",{className:"wd-action-btn primary",onClick:()=>je(s.method),disabled:p,children:"Set Primary"}),e.jsx("button",{className:"wd-action-btn remove",onClick:()=>ue(s.method),disabled:p||s.cooldown_active,children:"Remove"})]})]},i))]}),!H&&v.length===0?e.jsxs("div",{className:"wd-add-section",children:[e.jsx("h4",{style:{margin:"16px 0 12px",color:"#e2e8f0",fontSize:15},children:"Set Up Withdrawal Method"}),e.jsx("p",{style:{color:"#64748b",fontSize:13,margin:"0 0 12px"},children:"Add a withdrawal method to receive automatic weekly payouts every Friday. You can have one method at a time. A 48-hour cooldown applies after changes."}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"wd-add-btn mpesa",onClick:()=>J("mpesa"),disabled:p,children:"+ Add M-Pesa"}),e.jsx("button",{className:"wd-add-btn whop",onClick:()=>J("whop"),disabled:p,children:p?"Linking...":"+ Add Whop â€” Link email associated with your account"})]}),e.jsxs("p",{style:{color:"#64748b",fontSize:13,margin:"12px 0 0"},children:["Don't have a Whop account? Don't worry â€” you can"," ",e.jsx("a",{href:"https://whop.com/signup",target:"_blank",rel:"noopener noreferrer",style:{color:"#a78bfa",textDecoration:"underline"},children:"create one here"})," ","and link it to your account."]}),e.jsx("p",{style:{color:"#f59e0b",fontSize:13,margin:"8px 0 0"},children:"Note: You will need to verify your Whop account in order to receive payments."})]}):H==="mpesa"&&e.jsxs("div",{className:"wd-add-form",children:[e.jsx("h4",{style:{margin:"16px 0 12px",color:"#e2e8f0",fontSize:15},children:K?"Verify Phone Number":"Add M-Pesa Number"}),K?e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{color:"#64748b",fontSize:13,margin:"0 0 12px"},children:"Enter the 6-digit code sent to your email."}),e.jsxs("div",{className:"withdraw-form-group",children:[e.jsx("label",{children:"Verification Code"}),e.jsx("input",{type:"text",placeholder:"000000",value:F,onChange:s=>q(s.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,style:{letterSpacing:8,textAlign:"center",fontSize:20}})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"wd-add-btn mpesa",onClick:ye,disabled:p,children:p?"Verifying...":"Verify"}),e.jsx("button",{className:"wd-action-btn remove",onClick:()=>{C(!1),r({type:"",text:""})},children:"Back"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{color:"#64748b",fontSize:13,margin:"0 0 12px"},children:"Enter your M-Pesa phone number. We'll send a verification code to your email."}),e.jsxs("div",{className:"withdraw-form-group",children:[e.jsx("label",{children:"M-Pesa Phone Number"}),e.jsx("input",{type:"tel",placeholder:"0712345678",value:O,onChange:s=>U(s.target.value),maxLength:13})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"wd-add-btn mpesa",onClick:me,disabled:p,children:p?"Sending...":"Send OTP"}),e.jsx("button",{className:"wd-action-btn remove",onClick:()=>{$(null),r({type:"",text:""})},children:"Cancel"})]})]})]}),v.length>0&&e.jsxs("div",{className:"wd-fee-section",children:[e.jsx("h4",{style:{margin:"24px 0 12px",color:"#e2e8f0",fontSize:15},children:"Fee Calculator"}),e.jsx("p",{style:{color:"#64748b",fontSize:13,margin:"0 0 12px"},children:"See how much you'll receive after withdrawal fees."}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"flex-end",flexWrap:"wrap"},children:[e.jsxs("div",{className:"withdraw-form-group",style:{margin:0,flex:"1 1 120px"},children:[e.jsx("label",{children:"Amount (USD)"}),e.jsx("input",{type:"number",min:"5",step:"1",placeholder:"10.00",id:"fee-preview-amount"})]}),e.jsxs("div",{className:"withdraw-form-group",style:{margin:0,flex:"1 1 120px"},children:[e.jsx("label",{children:"Method"}),e.jsx("select",{id:"fee-preview-method",style:{width:"100%",padding:"10px 12px",background:"#111827",border:"1px solid #1e293b",borderRadius:8,color:"#e2e8f0",fontSize:14,fontFamily:"inherit"},children:v.map(s=>e.jsx("option",{value:s.method,children:s.method==="mpesa"?"M-Pesa (KES)":"Whop (USD)"},s.method))})]}),e.jsx("button",{className:"wd-add-btn whop",style:{padding:"10px 16px",height:42},onClick:()=>{const s=document.getElementById("fee-preview-amount")?.value,i=document.getElementById("fee-preview-method")?.value;s&&i&&we(s,i)},disabled:G,children:G?"...":"Calculate"})]}),o&&o.success&&e.jsxs("div",{className:"wd-fee-result",children:[o.method==="mpesa"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"wd-fee-row",children:[e.jsx("span",{children:"Amount"}),e.jsxs("span",{children:["$",o.amount_usd.toFixed(2)," = KES ",o.amount_kes?.toFixed(0)]})]}),e.jsxs("div",{className:"wd-fee-row",children:[e.jsx("span",{children:"Exchange Rate"}),e.jsxs("span",{children:["1 USD = ",o.exchange_rate?.toFixed(2)," KES"]})]}),e.jsxs("div",{className:"wd-fee-row fee",children:[e.jsx("span",{children:"Transaction Fee"}),e.jsxs("span",{children:["- KES ",o.fee_kes]})]}),e.jsxs("div",{className:"wd-fee-row total",children:[e.jsx("span",{children:"You Receive"}),e.jsxs("span",{children:["KES ",o.net_amount_kes?.toFixed(0)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"wd-fee-row",children:[e.jsx("span",{children:"Amount"}),e.jsxs("span",{children:["$",o.gross_amount_usd?.toFixed(2)]})]}),e.jsxs("div",{className:"wd-fee-row fee",children:[e.jsx("span",{children:"Platform Fee (3%)"}),e.jsxs("span",{children:["- $",o.platform_fee_usd?.toFixed(2)]})]}),e.jsxs("div",{className:"wd-fee-row fee",children:[e.jsx("span",{children:"Processing Fee (2.7% + $0.30)"}),e.jsxs("span",{children:["- $",o.processing_fee_usd?.toFixed(2)]})]}),e.jsxs("div",{className:"wd-fee-row total",children:[e.jsx("span",{children:"You Receive"}),e.jsxs("span",{children:["$",o.net_amount_usd?.toFixed(2)]})]})]}),e.jsx("p",{className:"wd-fee-desc",children:o.fee_description})]})]})]})]}),h==="referrals"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"creator-section",children:e.jsxs("div",{style:a.analyticsGrid,children:[e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",children:[e.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),e.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]})}),e.jsx("div",{style:a.analyticsValue,children:d?"****":`$${W.total_earned.toFixed(2)}`}),e.jsx("div",{style:a.analyticsLabel,children:"Total Earned"})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#3b82f6",strokeWidth:"2",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"8.5",cy:"7",r:"4"}),e.jsx("line",{x1:"20",y1:"8",x2:"20",y2:"14"}),e.jsx("line",{x1:"23",y1:"11",x2:"17",y2:"11"})]})}),e.jsx("div",{style:a.analyticsValue,children:Q?.total_referred||0}),e.jsx("div",{style:a.analyticsLabel,children:"Total Referrals"})]}),e.jsxs("div",{style:a.analyticsCard,children:[e.jsx("div",{style:a.analyticsIcon,children:e.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"#eab308",strokeWidth:"2",children:e.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}),e.jsx("div",{style:a.analyticsValue,children:Q?.pro_referred||0}),e.jsx("div",{style:a.analyticsLabel,children:"Pro Referrals"})]})]})}),e.jsxs("div",{className:"creator-section",children:[e.jsx("h3",{children:t("creator.referralEarnings")}),W.earnings.length===0?e.jsx("p",{className:"creator-empty-text",children:t("creator.noReferralEarnings")}):e.jsx("div",{className:"creator-sales-list",children:W.earnings.map((s,i)=>e.jsxs("div",{className:"creator-sale-row",children:[e.jsxs("span",{className:"sale-match",children:[e.jsx("span",{style:{color:"#94a3b8",fontSize:12},children:t("creator.referredUser")}),e.jsx("br",{}),e.jsx("span",{style:{fontSize:13},children:s.subscription_plan})]}),e.jsx("span",{className:"sale-amount",style:{color:"#22c55e"},children:d?"***":`+$${s.commission_amount.toFixed(2)}`}),e.jsx("span",{className:"sale-date",children:new Date(s.created_at).toLocaleDateString()})]},i))})]})]}),ae&&e.jsx("div",{className:"withdraw-modal-overlay",onClick:()=>N(!1),children:e.jsxs("div",{className:"withdraw-modal",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{className:"mpesa-modal-close",onClick:()=>N(!1),children:"Ã—"}),S?.success?e.jsxs("div",{className:"withdraw-success",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),e.jsx("h4",{children:"Withdrawal Requested"}),e.jsx("p",{children:S.message}),e.jsx("button",{className:"mpesa-retry-btn",onClick:()=>N(!1),children:t("common.close")})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{children:"Withdraw Earnings"}),e.jsxs("p",{className:"withdraw-balance",children:["Available: ",e.jsxs("strong",{children:["$",n.balance_usd.toFixed(2)]})]}),e.jsxs("div",{style:a.methodToggle,children:[e.jsxs("button",{style:{...a.methodBtn,...y==="mpesa"?a.methodBtnActive:{}},onClick:()=>I("mpesa"),children:[e.jsx("span",{style:{fontSize:16},children:"ðŸ“±"})," M-Pesa (KES)"]}),e.jsxs("button",{style:{...a.methodBtn,...y==="whop"?a.methodBtnActive:{},...u?{}:a.methodBtnDisabled},onClick:()=>u&&I("whop"),disabled:!u,title:u?"":"Make a card payment first to link your Whop account",children:[e.jsx("span",{style:{fontSize:16},children:u?"ðŸ’³":"ðŸ”’"})," Whop (USD)"]})]}),!u&&y==="mpesa"&&e.jsx("p",{style:a.whopHint,children:"Want USD payouts? Make any card payment to automatically link your Whop account."}),e.jsxs("div",{className:"withdraw-form-group",children:[e.jsx("label",{children:"Amount (USD)"}),e.jsx("input",{type:"number",min:"5",max:n.balance_usd,step:"0.50",placeholder:"5.00",value:_,onChange:s=>E(s.target.value)})]}),y==="mpesa"&&e.jsxs("div",{className:"withdraw-form-group",children:[e.jsx("label",{children:"M-Pesa Phone Number"}),e.jsx("input",{type:"tel",placeholder:"0712345678",value:P,onChange:s=>te(s.target.value),maxLength:13})]}),e.jsx("p",{className:"withdraw-info-text",children:y==="mpesa"?"Minimum withdrawal: $5.00. You'll receive the KES equivalent via M-Pesa within 24 hours.":"Minimum withdrawal: $5.00. USD will be transferred to your Whop account instantly upon admin approval."}),S?.error&&e.jsx("div",{className:"mpesa-error",children:S.error}),e.jsx("button",{className:"withdraw-submit-btn",onClick:xe,disabled:D||!_||parseFloat(_)<5,children:D?"Requesting...":t("creator.requestWithdrawal")})]})]})})]})}const a={analyticsGrid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:12},analyticsCard:{background:"#111827",border:"1px solid #1e293b",borderRadius:10,padding:"14px 16px",textAlign:"center"},analyticsIcon:{marginBottom:6},analyticsValue:{fontSize:22,fontWeight:700,color:"#f1f5f9"},analyticsLabel:{fontSize:11,color:"#64748b",marginTop:2,textTransform:"uppercase",letterSpacing:.5},tabBar:{display:"flex",gap:4,background:"#0f1629",border:"1px solid #1e293b",borderRadius:10,padding:4,marginTop:12,marginBottom:20,overflowX:"auto",WebkitOverflowScrolling:"touch",scrollbarWidth:"none"},tab:{flex:"none",padding:"10px 14px",background:"none",border:"none",borderRadius:8,color:"#64748b",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all 0.15s",fontFamily:"inherit",whiteSpace:"nowrap"},tabActive:{background:"#1e293b",color:"#f1f5f9",fontWeight:700},tableHeader:{display:"flex",alignItems:"center",gap:8,padding:"8px 12px",borderBottom:"1px solid #1e293b",marginBottom:4},tableRow:{display:"flex",alignItems:"center",gap:8,padding:"10px 12px",borderBottom:"1px solid rgba(30,41,59,0.5)",transition:"background 0.15s"},col:{display:"flex",flexDirection:"column",fontSize:12,color:"#94a3b8",minWidth:0},colNum:{width:50,textAlign:"center",fontSize:13,color:"#cbd5e1",flexShrink:0},paidBadge:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:"#6c5ce7",color:"#fff",fontSize:10,fontWeight:700},resultBadge:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",color:"#fff",fontSize:10,fontWeight:700},methodToggle:{display:"flex",gap:8,marginBottom:16},methodBtn:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",gap:6,padding:"10px 12px",background:"#1e293b",border:"1px solid #334155",borderRadius:8,color:"#94a3b8",fontSize:13,fontWeight:500,cursor:"pointer",transition:"all 0.15s",fontFamily:"inherit"},methodBtnActive:{background:"rgba(59, 130, 246, 0.15)",borderColor:"#3b82f6",color:"#60a5fa"},methodBtnDisabled:{opacity:.5,cursor:"not-allowed"},whopHint:{fontSize:11,color:"#64748b",margin:"0 0 12px 0",textAlign:"center",lineHeight:1.4}};export{_e as default};
