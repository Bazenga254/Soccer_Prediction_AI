import{u as ee,a as ae,f as se,r as c,c as o,j as e}from"./index-B3SC9TNl.js";import{M as ne,W as le}from"./WhopCheckoutModal-DrBcKNRG.js";function te(){const{t:a}=ee(),{user:C}=ae(),{currency:l,currencySymbol:r,isKenyan:i}=se(),[h,O]=c.useState({}),[g,$]=c.useState(null),[A,G]=c.useState(!1),[Y,V]=c.useState(!0),[u,S]=c.useState({open:!1,planId:"",amountKes:0,amountUsd:0,title:"",description:"",txType:"subscription"}),[m,L]=c.useState(null),[t,q]=c.useState(l==="KES"?100:1),[k,ce]=c.useState(100),[b,K]=c.useState({open:!1,transactionType:"",planId:"",amountUsd:0,title:""}),[E,z]=c.useState(null),[F,H]=c.useState(null),[p,B]=c.useState(!1);c.useEffect(()=>{(async()=>{try{const[s,d,N,P,_]=await Promise.allSettled([o.get("/api/subscription/plans"),o.get("/api/subscription/status"),o.get("/api/user/balance"),o.get("/api/pricing"),o.get("/api/user/earnings")]);s.status==="fulfilled"&&O(s.value.data.plans||{}),d.status==="fulfilled"&&($(d.value.data.subscription),G(!d.value.data.has_used_trial)),N.status==="fulfilled"&&L(N.value.data.balance),P.status==="fulfilled"&&z(P.value.data),_.status==="fulfilled"&&H({balance_usd:_.value.data.balance_usd||0,balance_kes:_.value.data.balance_kes||0})}catch{}V(!1)})()},[]);const[w,J]=c.useState(130);if(c.useEffect(()=>{l==="KES"&&o.post("/api/payment/quote",{amount_usd:1}).then(n=>{n.data.amount_kes&&J(n.data.amount_kes)}).catch(()=>{})},[l]),Y)return e.jsx("div",{className:"upgrade-page",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:a("upgrade.loadingPlans")})]})});const x=C?.tier==="pro",U=C?.tier==="trial",y=x||U,v=l==="USD"?h.weekly_usd:h.weekly_kes,f=l==="USD"?h.monthly_usd:h.monthly_kes,j=l==="USD"?h.trial_usd:h.trial_kes,Q=["weekly_usd","weekly_kes","monthly_usd","monthly_kes","trial_usd","trial_kes"],X=Object.entries(h).filter(([n])=>!Q.includes(n)).filter(([,n])=>n.currency===l),I=l==="KES"?E?.pay_per_use?.match_analysis_price_kes??25:E?.pay_per_use?.match_analysis_price_usd??.25,W=l==="KES"?E?.pay_per_use?.jackpot_analysis_price_kes??65:E?.pay_per_use?.jackpot_analysis_price_usd??.65,D=(n,s)=>{if(s.currency==="KES"||i){const d=s.duration_days===3?"3 days":s.duration_days===7?"week":"month";S({open:!0,planId:n,amountKes:s.currency==="KES"?s.price:0,amountUsd:s.currency==="USD"?s.price:0,title:`Subscribe to ${s.name}`,description:`${s.currency==="KES"?"KES":"$"}${s.currency==="KES"?" "+s.price.toLocaleString():s.price} / ${d}`,txType:"subscription"})}else K({open:!0,transactionType:"subscription",planId:n,amountUsd:s.price,title:`Subscribe to ${s.name}`})},Z=()=>{if(i){if(t<k)return;S({open:!0,planId:"balance_topup",amountKes:t,amountUsd:0,title:"Deposit to Balance",description:`KES ${t.toLocaleString()} Pay on the Go deposit`,txType:"balance_topup"})}else{if(t<1)return;S({open:!0,planId:"balance_topup",amountKes:0,amountUsd:t,title:"Deposit to Balance",description:`$${t.toFixed(2)} Pay on the Go deposit`,txType:"balance_topup"})}},M=n=>{const s=n?.currency||l,d=m?.balance_usd||0,N=m?.balance_kes||0,P=F?.balance_usd||0,_=F?.balance_kes||0;return s==="KES"?Math.round(d*w)+Math.round(N)+Math.round(P*w)+Math.round(_):d+P+(w>0?(N+_)/w:0)},T=async n=>{if(!p){B(!0);try{const s=await o.post("/api/subscription/pay-with-balance",{plan_id:n});s.data.success&&(alert(`Subscription activated! Expires: ${s.data.expires_at?.slice(0,10)}`),window.location.reload())}catch(s){alert(s.response?.data?.detail||"Payment failed")}finally{B(!1)}}},R=async()=>{S({open:!1,planId:"",amountKes:0,amountUsd:0,title:"",description:"",txType:"subscription"}),K({open:!1,transactionType:"",planId:"",amountUsd:0,title:""});try{const[n,s]=await Promise.allSettled([o.get("/api/subscription/status"),o.get("/api/user/balance")]);n.status==="fulfilled"&&$(n.value.data.subscription),s.status==="fulfilled"&&L(s.value.data.balance),window.location.reload()}catch{}};return e.jsxs("div",{className:"upgrade-page",children:[x&&g&&e.jsx("div",{className:"active-sub-banner",children:e.jsxs("div",{className:"sub-banner-content",children:[e.jsx("span",{className:"sub-banner-badge",children:a("upgrade.proActive")}),e.jsx("span",{className:"sub-banner-text",children:a("upgrade.expiresOn",{date:new Date(g.expires_at).toLocaleDateString(),days:g.days_remaining})})]})}),U&&g&&e.jsx("div",{className:"active-sub-banner trial-banner",children:e.jsxs("div",{className:"sub-banner-content",children:[e.jsx("span",{className:"sub-banner-badge trial",children:"TRIAL ACTIVE"}),e.jsxs("span",{className:"sub-banner-text",children:["Your trial expires on ",new Date(g.expires_at).toLocaleDateString()," (",g.days_remaining," days remaining). Upgrade to continue!"]})]})}),e.jsxs("div",{className:"upgrade-header",children:[e.jsx("h2",{children:a(y?"upgrade.manageSub":"upgrade.title")}),e.jsx("p",{className:"upgrade-subtitle",children:y?U?"You are on a 3-day trial. Upgrade to a full plan for unlimited access!":a("upgrade.fullAccess"):a("upgrade.unlockFeatures")})]}),e.jsxs("div",{className:"plans-grid",children:[!A&&!y&&e.jsxs("div",{className:"plan-card current",children:[e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:a("upgrade.freePlan")}),e.jsxs("div",{className:"plan-price",children:[e.jsxs("span",{className:"price-amount",children:[r,"0"]}),e.jsx("span",{className:"price-period",children:a("upgrade.forever")})]})]}),e.jsxs("ul",{className:"plan-features",children:[e.jsx("li",{className:"feature-item",children:a("upgrade.freeFeature1")}),e.jsx("li",{className:"feature-item",children:a("upgrade.freeFeature2")}),e.jsx("li",{className:"feature-item",children:a("upgrade.freeFeature3")}),e.jsx("li",{className:"feature-item",children:a("upgrade.freeFeature4")}),e.jsx("li",{className:"feature-item",children:a("upgrade.freeFeature5")}),e.jsx("li",{className:"feature-item disabled",children:a("upgrade.advancedAnalytics")}),e.jsx("li",{className:"feature-item disabled",children:a("upgrade.valueBetting")}),e.jsx("li",{className:"feature-item disabled",children:a("upgrade.adFree")})]}),e.jsx("div",{className:"plan-current-badge",children:a("upgrade.currentPlan")})]}),A&&!y&&j&&e.jsxs("div",{className:"plan-card trial",children:[e.jsxs("div",{className:"plan-ribbon trial-ribbon",children:["Try for ",r,j.price,"!"]}),e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:"3-Day Trial"}),e.jsxs("div",{className:"plan-price",children:[e.jsxs("span",{className:"price-amount",children:[r,j.price]}),e.jsx("span",{className:"price-period",children:"/ 3 days"})]})]}),e.jsx("ul",{className:"plan-features",children:(j.features||[]).map((n,s)=>e.jsx("li",{className:"feature-item included",children:n},s))}),e.jsxs("div",{className:"plan-btn-group",children:[e.jsx("button",{className:"plan-upgrade-btn trial-btn",onClick:()=>D(l==="USD"?"trial_usd":"trial_kes",j),children:l==="KES"?"Pay with M-Pesa":"Start 3-Day Trial"}),M(j)>=j.price&&e.jsx("button",{className:"plan-upgrade-btn balance-btn",disabled:p,onClick:()=>T(l==="USD"?"trial_usd":"trial_kes"),children:p?"Processing...":"Pay with Balance"})]})]}),v&&e.jsxs("div",{className:`plan-card pro ${x?"current":"recommended"}`,children:[!y&&e.jsx("div",{className:"plan-ribbon",children:a("upgrade.popular")}),e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:a("upgrade.proWeekly")}),e.jsxs("div",{className:"plan-price",children:[e.jsxs("span",{className:"price-amount",children:[r,v.price]}),e.jsx("span",{className:"price-period",children:a("upgrade.perWeek")})]})]}),e.jsx("ul",{className:"plan-features",children:v.features.map((n,s)=>e.jsx("li",{className:"feature-item included",children:n},s))}),x?e.jsx("div",{className:"plan-current-badge pro",children:a("common.active")}):e.jsxs("div",{className:"plan-btn-group",children:[e.jsx("button",{className:"plan-upgrade-btn",onClick:()=>D(l==="USD"?"weekly_usd":"weekly_kes",v),children:a(l==="KES"?"upgrade.payWithMpesa":"upgrade.upgradeNow")}),M(v)>=v.price&&e.jsx("button",{className:"plan-upgrade-btn balance-btn",disabled:p,onClick:()=>T(l==="USD"?"weekly_usd":"weekly_kes"),children:p?"Processing...":"Pay with Balance"})]})]}),f&&e.jsxs("div",{className:"plan-card pro-monthly",children:[e.jsx("div",{className:"plan-save-tag",children:a("upgrade.save20")}),e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:a("upgrade.proMonthly")}),e.jsxs("div",{className:"plan-price",children:[e.jsxs("span",{className:"price-amount",children:[r,f.price]}),e.jsx("span",{className:"price-period",children:a("upgrade.perMonth")})]})]}),e.jsx("ul",{className:"plan-features",children:f.features.map((n,s)=>e.jsx("li",{className:"feature-item included",children:n},s))}),x?e.jsx("div",{className:"plan-current-badge pro",children:a("common.active")}):e.jsxs("div",{className:"plan-btn-group",children:[e.jsx("button",{className:"plan-upgrade-btn monthly",onClick:()=>D(l==="USD"?"monthly_usd":"monthly_kes",f),children:a(l==="KES"?"upgrade.payWithMpesa":"upgrade.upgradeNow")}),M(f)>=f.price&&e.jsx("button",{className:"plan-upgrade-btn balance-btn",disabled:p,onClick:()=>T(l==="USD"?"monthly_usd":"monthly_kes"),children:p?"Processing...":"Pay with Balance"})]})]}),X.map(([n,s])=>e.jsxs("div",{className:"plan-card pro-extra",children:[e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:s.name}),e.jsxs("div",{className:"plan-price",children:[e.jsxs("span",{className:"price-amount",children:[s.currency==="KES"?"KES ":"$",s.price]}),e.jsx("span",{className:"price-period",children:s.duration_days===1?"/ day":s.duration_days===7?"/ week":s.duration_days===30?"/ month":`/ ${s.duration_days} days`})]})]}),e.jsx("ul",{className:"plan-features",children:(s.features||[]).map((d,N)=>e.jsx("li",{className:"feature-item included",children:d},N))}),x?e.jsx("div",{className:"plan-current-badge pro",children:a("common.active")}):e.jsxs("div",{className:"plan-btn-group",children:[e.jsx("button",{className:"plan-upgrade-btn",onClick:()=>D(n,s),children:s.currency==="KES"?a("upgrade.payWithMpesa"):a("upgrade.upgradeNow")}),M(s)>=s.price&&e.jsx("button",{className:"plan-upgrade-btn balance-btn",disabled:p,onClick:()=>T(n),children:p?"Processing...":"Pay with Balance"})]})]},n))]}),!y&&e.jsx("div",{className:"paygo-section",children:e.jsxs("div",{className:"plan-card paygo",children:[e.jsx("div",{className:"plan-ribbon paygo-ribbon",children:a("upgrade.flexible")}),e.jsxs("div",{className:"plan-header",children:[e.jsx("h3",{className:"plan-name",children:a("upgrade.payOnTheGo")}),e.jsxs("div",{className:"plan-price",children:[e.jsx("span",{className:"price-amount",children:i?`From KES ${k.toLocaleString()}`:a("upgrade.fromDeposit")}),e.jsx("span",{className:"price-period",children:a("upgrade.deposit")})]})]}),e.jsxs("div",{className:"paygo-pricing",children:[e.jsxs("div",{className:"paygo-price-item",children:[e.jsx("span",{className:"paygo-price-label",children:a("upgrade.matchAnalysis")}),e.jsxs("span",{className:"paygo-price-value",children:[r,I.toFixed(2)]})]}),e.jsxs("div",{className:"paygo-price-item",children:[e.jsx("span",{className:"paygo-price-label",children:a("upgrade.jackpotAnalysis")}),e.jsxs("span",{className:"paygo-price-value",children:[r,W.toFixed(2)]})]})]}),e.jsxs("ul",{className:"plan-features",children:[e.jsx("li",{className:"feature-item included",children:a("upgrade.unlockAnalysis")}),e.jsx("li",{className:"feature-item included",children:a("upgrade.payWhenNeeded")}),e.jsx("li",{className:"feature-item included",children:a("upgrade.noCommitment")}),e.jsx("li",{className:"feature-item included",children:i?`Deposit any amount (KES ${k.toLocaleString()} min)`:a("upgrade.depositMin")}),e.jsx("li",{className:"feature-item included",children:a("upgrade.balanceNoExpiry")})]}),m&&((m.balance_usd||0)>0||(m.balance_kes||0)>0)&&e.jsxs("div",{className:"paygo-balance",children:[a("upgrade.balance"),": ",e.jsx("strong",{children:i?`KES ${(Math.round((m.balance_usd||0)*w)+Math.round(m.balance_kes||0)).toLocaleString()}`:`$${(m.balance_usd||0).toFixed(2)}`})]}),e.jsxs("div",{className:"paygo-deposit-row",children:[e.jsxs("div",{className:"paygo-input-group",children:[e.jsx("span",{className:"paygo-input-prefix",children:r}),e.jsx("input",{type:"number",min:i?k:1,step:i?10:1,value:t,onChange:n=>q(Math.max(i?k:1,Number(n.target.value))),className:"paygo-input"})]}),e.jsx("button",{className:"paygo-deposit-btn",onClick:Z,children:a("upgrade.depositViaMpesa")}),!i&&e.jsx("button",{className:"paygo-deposit-btn card",onClick:()=>{t<1||K({open:!0,transactionType:"balance_topup",planId:"",amountUsd:t,title:`Deposit $${t.toFixed(2)} to Balance`})},children:a("upgrade.depositViaCard")})]})]})}),!x&&!U&&e.jsxs("div",{className:"payment-methods-info",children:[e.jsx("h3",{children:a("upgrade.paymentMethods")}),e.jsxs("div",{className:"payment-methods-grid",children:[e.jsxs("div",{className:"payment-method active",children:[e.jsx("span",{className:"pm-icon",children:"ðŸ“±"}),e.jsx("span",{className:"pm-name",children:"M-Pesa"}),e.jsx("span",{className:"pm-note",children:a("upgrade.payWithMpesaNote")})]}),!i&&e.jsxs("div",{className:"payment-method active",children:[e.jsx("span",{className:"pm-icon",children:"ðŸ’³"}),e.jsx("span",{className:"pm-name",children:a("upgrade.cardPayment")}),e.jsx("span",{className:"pm-note",children:a("upgrade.cardPaymentNote")})]})]}),e.jsx("p",{className:"payment-note",children:a("upgrade.paymentMethodsNote")})]}),e.jsx(ne,{isOpen:u.open,onClose:()=>S({...u,open:!1}),onSuccess:R,amountKes:u.amountKes,amountUsd:u.amountUsd||0,transactionType:u.txType||"subscription",referenceId:u.planId,title:u.title,description:u.description}),e.jsx(le,{isOpen:b.open,onClose:()=>K({...b,open:!1}),onSuccess:R,transactionType:b.transactionType,planId:b.planId,amountUsd:b.amountUsd,title:b.title}),e.jsxs("div",{className:"comparison-section",children:[e.jsx("h3",{children:a("upgrade.comparisonTitle")}),e.jsx("p",{className:"comparison-subtitle",children:"See what each plan offers at a glance"}),e.jsxs("div",{className:"comparison-table wide",children:[e.jsxs("div",{className:"comparison-header",children:[e.jsx("span",{children:a("upgrade.feature")}),e.jsx("span",{children:a("upgrade.freePlan")}),e.jsx("span",{children:a("upgrade.payOnTheGo")}),e.jsx("span",{className:"pro-col-header",children:a("common.pro")})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.matchAnalysis")}),e.jsx("span",{children:a("upgrade.threePer24h")}),e.jsxs("span",{children:[r,I," each"]}),e.jsx("span",{className:"pro-value",children:"20 per day"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.jackpotAnalysis")}),e.jsx("span",{children:a("upgrade.twoThen172h")}),e.jsxs("span",{children:[r,W," each"]}),e.jsx("span",{className:"pro-value",children:"5 per day"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.aiChatPrompts")}),e.jsx("span",{children:a("upgrade.total10")}),e.jsx("span",{children:a("upgrade.total10")}),e.jsx("span",{className:"pro-value",children:"50 per day"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"Live Score Tracking"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"40+ Leagues Worldwide"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"Odds Comparison"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.advancedAnalytics")}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.valueBetting")}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"Chrome Extension"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"Community Predictions"}),e.jsx("span",{children:"1 share/day"}),e.jsx("span",{children:"1 share/day"}),e.jsx("span",{className:"pro-value",children:a("upgrade.unlimited")})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:"Sell Predictions"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.advertisements")}),e.jsx("span",{className:"has-ads",children:"Yes"}),e.jsx("span",{className:"has-ads",children:"Yes"}),e.jsx("span",{className:"pro-value",children:a("upgrade.none")})]}),e.jsxs("div",{className:"comparison-row",children:[e.jsx("span",{className:"feature-label",children:a("upgrade.prioritySupport")}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"no-value",children:"â€”"}),e.jsx("span",{className:"pro-value check-value",children:"âœ“"})]})]})]})]})}export{te as default};
