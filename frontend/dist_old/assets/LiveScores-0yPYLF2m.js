import{u as Be,a as Ke,r as c,b as qe,c as ie,j as e}from"./index-B3SC9TNl.js";import{L as Qe}from"./LiveChatPopup-CShmYYEy.js";import{i as ze}from"./sounds-Ck9TXWp9.js";const Ae={tracking_started:["Good Choice! ðŸ‘","Let's Go! ðŸ”¥","Locked In! ðŸ”’","Game On! ðŸŽ®","You're Set! âœ…","Eyes On! ðŸ‘€"],celebration:["GOOOAAAL! ðŸŽ‰","GET IN! ðŸ’ª","YESSS! ðŸ”¥","WHAT A GOAL! âš½","UNSTOPPABLE! ðŸš€","BEAUTY! ðŸ˜","TAKE A BOW! ðŸŽ¯","SCENES! ðŸŽŠ"],sad:["Oh No... ðŸ˜¢","Gutted... ðŸ’”","That Hurts... ðŸ˜©","Nooo! ðŸ˜­","Stay Strong... ðŸ¥º","Pain... ðŸ’€"],worried:["It's Level... ðŸ˜°","All Square... ðŸ˜¬","Nervous Times... ðŸ«£","Hold On... ðŸ˜¤","Don't Panic... ðŸ™"],big_lead:["RUNNING RIOT! ðŸ†","UNSTOPPABLE! ðŸ’«","ON FIRE! ðŸ”¥ðŸ”¥ðŸ”¥","DEMOLITION! ðŸ’ª","TOO EASY! ðŸ˜Ž"],match_won:["VICTORY! ðŸ†","WE WON! ðŸŽ‰ðŸŽ‰","CHAMPIONS! ðŸ‘‘","FULL TIME - WIN! ðŸ”¥","GET IN THERE! ðŸ’ª","WHAT A WIN! ðŸ˜"],match_lost:["Full Time - Defeat ðŸ’”","We Lost... ðŸ˜­","Heartbreak ðŸ’€","Not Our Day... ðŸ˜¢","Tough Loss ðŸ˜©","Gutted... ðŸ˜ž"],match_draw:["Full Time - Draw ðŸ¤","Honors Even ðŸ˜","A Point Each ðŸ¤·","So Close... ðŸ˜”","Shared the Spoils ðŸ¤"]},Ge={tracking_started:["You made the right choice!","We'll keep you posted on every goal!","Sit back and enjoy the match!","You'll get notified when they score!","Tracking is live! Good luck!","May the best team win!"],celebration:["Your team just scored!","What a moment!","The crowd goes wild!","Pure class!","Brilliant finish!","Get in there!"],sad:["Stay strong, anything can happen!","Keep believing!","It's not over yet...","There is still time!","Chin up!"],worried:["Come on, you can do this!","Time to fight back!","It's anyone's game now!","Stay focused!","Deep breaths..."],big_lead:["Absolutely dominant!","No mercy!","A masterclass!","Running the show!","Total control!"],match_won:["Congratulations! What a performance!","Your team did it!","Three points in the bag!","Well deserved victory!","Time to celebrate!","What a result!"],match_lost:["Better luck next time...","There's always the next match.","Keep your head up!","It wasn't meant to be today.","Chin up, move forward!","The comeback starts next match!"],match_draw:["A fair result in the end.","Could have gone either way.","Not a bad point away from home.","Almost had it!","On to the next one!"]},ne={tracking_started:["https://media.giphy.com/media/l0MYt5jPR6QX5APm0/200.gif","https://media.giphy.com/media/3oEjHV0z8S7WM4MwnK/200.gif","https://media.giphy.com/media/xTiTnEHBh7qapSf11u/200.gif","https://media.giphy.com/media/YRuFixSNWFVcXaxpmX/200.gif","https://media.giphy.com/media/artj92V8o75VPL7AeQ/200.gif","https://media.giphy.com/media/3oz8xIsloV320wXd6M/200.gif"],celebration:["https://media.giphy.com/media/3o7bu2D938PkrKrcYw/200.gif","https://media.giphy.com/media/vGxiQNwXOrc17Aanuf/200.gif","https://media.giphy.com/media/sirOb06HhLmVxV0LtQ/200.gif","https://media.giphy.com/media/l3UcicwEsOOan1Q2c/200.gif","https://media.giphy.com/media/KjFoWsZmuUzdoonjmz/200.gif","https://media.giphy.com/media/QxMb25h7RhitNWgyy0/200.gif"],sad:["https://media.giphy.com/media/rDf21Jd6npuG94c8pe/200.gif","https://media.giphy.com/media/Nuk8ZhBtEsS6kMBNCb/200.gif","https://media.giphy.com/media/7SEVVDyj4dXyhIjcIh/200.gif","https://media.giphy.com/media/c5nW05OqnQ5MsRM7X1/200.gif","https://media.giphy.com/media/1naY1TdNLTlSEdzi5D/200.gif","https://media.giphy.com/media/tFKHi78AVX0QkLuLeX/200.gif"],worried:["https://media.giphy.com/media/3oz8xLlw6GHVfokaNW/200.gif","https://media.giphy.com/media/5io17TpOzP17cPqHpI/200.gif","https://media.giphy.com/media/UJBrPPqsMpVtzBeHOZ/200.gif","https://media.giphy.com/media/4QgiErmjZiPESRcKYt/200.gif","https://media.giphy.com/media/Z406ds5hiUAoYUe9TR/200.gif","https://media.giphy.com/media/l4FATJpd4LWgeruTK/200.gif"],big_lead:["https://media.giphy.com/media/nbQiWoHJFaJtcl3qT6/200.gif","https://media.giphy.com/media/KQARp0xmXD90CIOIcb/200.gif","https://media.giphy.com/media/DfbpTbQ9TvSX6/200.gif","https://media.giphy.com/media/cZGwq7OWe0fStVrzND/200.gif","https://media.giphy.com/media/15BuyagtKucHm/200.gif","https://media.giphy.com/media/l4pTcr7Nbt29Hpx72/200.gif"],match_won:["https://media.giphy.com/media/26u4exk4zsAqPcq08/200.gif","https://media.giphy.com/media/cuKExiRZlVoPK92Bth/200.gif","https://media.giphy.com/media/oIGXtRBYxIYyXTnSnm/200.gif","https://media.giphy.com/media/2vlkAmFl8FOTogdUx0/200.gif","https://media.giphy.com/media/QR4UX8k7bQX1gKJp6i/200.gif","https://media.giphy.com/media/QAIGlJZqbnc0UYQn7U/200.gif"],match_lost:["https://media.giphy.com/media/l1OBiDMmjQqXPpcSa4/200.gif","https://media.giphy.com/media/naKDoT6SAIqDavX3WQ/200.gif","https://media.giphy.com/media/6rLNAzFoLz3aIy41r9/200.gif","https://media.giphy.com/media/BE2wVc1nuX0tvxbGCL/200.gif","https://media.giphy.com/media/7kJ49xKZsckr8yV87R/200.gif","https://media.giphy.com/media/Tzl5kPytktnDqNu6tZ/200.gif"],match_draw:["https://media.giphy.com/media/JRhS6WoswF8FxE0g2R/200.gif","https://media.giphy.com/media/l4pTsh45Dg7jnDM6Q/200.gif","https://media.giphy.com/media/EYUNo9AHh1qvx87fH1/200.gif","https://media.giphy.com/media/eI3XK2wTJ9uPcc7cDv/200.gif","https://media.giphy.com/media/3o7bu2PMhUljurpnWM/200.gif","https://media.giphy.com/media/igGyenWV6Dy4rhXbc8/200.gif"]};function Je(){Object.values(ne).forEach(o=>{o.forEach(x=>{const j=new Image;j.src=x})})}const z={};function Me(o){return o[Math.floor(Math.random()*o.length)]}function Ze(o){const x=ne[o]||ne.celebration;z[o]||(z[o]=0);const j=x[z[o]%x.length];return z[o]++,j}function es(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()}function ss(o,x,j){if(!(!("Notification"in window)||Notification.permission!=="granted"))try{const L=new Notification(o,{body:x,icon:j||"/favicon.ico",badge:"/favicon.ico",tag:"spark-goal-"+Date.now(),renotify:!0});L.onclick=()=>{window.focus(),L.close()},setTimeout(()=>L.close(),1e4)}catch{}}const as={39:1,140:2,78:3,135:4,61:5,2:6,3:7,40:8,88:9,94:10,1:11,4:12,13:13};function ts(){if(ze())try{const o=new(window.AudioContext||window.webkitAudioContext),x=o.createOscillator(),j=o.createGain();x.connect(j),j.connect(o.destination),x.type="sine",x.frequency.setValueAtTime(800,o.currentTime),x.frequency.linearRampToValueAtTime(1200,o.currentTime+.15),x.frequency.linearRampToValueAtTime(1400,o.currentTime+.3),x.frequency.setValueAtTime(1400,o.currentTime+.3),x.frequency.linearRampToValueAtTime(800,o.currentTime+.5),j.gain.setValueAtTime(.3,o.currentTime),j.gain.linearRampToValueAtTime(0,o.currentTime+.6),x.start(o.currentTime),x.stop(o.currentTime+.6)}catch{}}function ls(){const{t:o}=Be(),{user:x}=Ke(),[j,L]=c.useState([]),[Pe,ce]=c.useState(!0),[J,le]=c.useState(null),[oe,Le]=c.useState(null),[T,Oe]=c.useState(null),[Z,re]=c.useState(null),[M,D]=c.useState("stats"),[Re,me]=c.useState({}),[$e,de]=c.useState({}),ee=c.useRef({}),I=c.useRef({}),[U,He]=c.useState(()=>{try{return JSON.parse(localStorage.getItem("live_favorites")||"[]")}catch{return[]}}),[W,he]=c.useState(new Set),ue=c.useRef({}),se=qe(),[A,X]=c.useState(()=>{try{return JSON.parse(localStorage.getItem("trackedMatches")||"{}")}catch{return{}}}),[pe,ge]=c.useState(null),[b,fe]=c.useState(null),ae=c.useRef([]),O=c.useRef(null),ye=c.useRef(A),Y=c.useRef({}),xe=c.useRef(new Set),[B,Ne]=c.useState([]),[je,ve]=c.useState(!0),[E,R]=c.useState(1),[P,we]=c.useState("live"),[$,be]=c.useState(null),Fe=a=>{He(i=>{const s=i.includes(a)?i.filter(p=>p!==a):[...i,a];return localStorage.setItem("live_favorites",JSON.stringify(s)),s})};c.useEffect(()=>{localStorage.setItem("trackedMatches",JSON.stringify(A)),ye.current=A},[A]),c.useEffect(()=>{Je(),es()},[]);const Se=(a,i)=>{const s=i===a.home_team.id,p={teamId:i,teamName:s?a.home_team.name:a.away_team.name,teamCrest:s?a.home_team.crest:a.away_team.crest,opponentName:s?a.away_team.name:a.home_team.name,homeGoals:a.goals?.home||0,awayGoals:a.goals?.away||0,isHome:s};X(r=>({...r,[a.id]:p})),ge(null),ue.current[a.id]=(a.goals?.home||0)+(a.goals?.away||0),te(a,p,"tracking_started",a.goals?.home||0,a.goals?.away||0)},Ve=a=>{X(i=>{const s={...i};return delete s[a],s})},H=c.useCallback(()=>{if(O.current=null,ae.current.length===0){fe(null);return}const a=ae.current.shift();fe(a),O.current=setTimeout(()=>{H()},8e3)},[]),te=c.useCallback((a,i,s,p,r)=>{const h=Ze(s),u=Me(Ae[s]||Ae.celebration),m=Me(Ge[s]||Ge.celebration),l={id:Date.now(),type:s,gifUrl:h,headline:u,subMessage:m,homeTeam:a.home_team.name,awayTeam:a.away_team.name,homeCrest:a.home_team.crest,awayCrest:a.away_team.crest,homeGoals:p,awayGoals:r,trackedTeam:i.teamName,trackedCrest:i.teamCrest};ae.current.push(l),ss(u.replace(/[\u{1F000}-\u{1FFFF}]/gu,"").trim(),`${a.home_team.name} ${p} - ${r} ${a.away_team.name}
${m}`,i.teamCrest||"/favicon.ico"),O.current||H()},[H]),ke=c.useCallback(()=>{clearTimeout(O.current),O.current=null,H()},[H]),K=c.useCallback(async(a,i,s,p=!1)=>{if(!(!p&&(ee.current[a]||I.current[a]))){I.current[a]=!0,de(r=>({...r,[a]:!0}));try{const h=(await ie.get(`/api/live-stats/${a}`)).data.statistics;if(h&&typeof h=="object"){const u={home:{},away:{}};Object.entries(h).forEach(([m,l])=>{parseInt(m)===i?u.home=l.stats||{}:parseInt(m)===s&&(u.away=l.stats||{})}),ee.current[a]=u,me(m=>({...m,[a]:u}))}}catch(r){console.error("[LiveScores] Stats fetch error for fixture",a,r)}I.current[a]=!1,de(r=>({...r,[a]:!1}))}},[]),De=c.useCallback(a=>{Oe(i=>{const s=i===a.id?null:a.id;return s&&K(a.id,a.home_team.id,a.away_team.id),s}),D("stats")},[K]),F=c.useCallback(async(a=!1)=>{try{a&&ce(!0);const s=(await ie.get("/api/live-matches")).data.matches||[],p=ue.current,r=new Set;s.forEach(m=>{const l=m.id,n=(m.goals?.home||0)+(m.goals?.away||0);p[l]!==void 0&&n>p[l]&&(r.add(l),ts()),p[l]=n,Y.current[l]||(Y.current[l]=m.status)}),r.size>0&&(he(r),setTimeout(()=>he(new Set),8e3));const h=ye.current;Object.keys(h).forEach(m=>{const l=s.find(N=>N.id===Number(m));if(!l)return;const n=h[m],g=l.goals?.home||0,y=l.goals?.away||0;if(g!==n.homeGoals||y!==n.awayGoals){const N=g>n.homeGoals,_=y>n.awayGoals,G=n.isHome&&N||!n.isHome&&_,C=n.isHome&&_||!n.isHome&&N,t=g===y,d=n.isHome?g:y,f=n.isHome?y:g,v=d-f>=2;let w="celebration";G&&v?w="big_lead":G?w="celebration":C&&t?w="worried":C&&(w="sad"),te(l,n,w,g,y),X(k=>({...k,[m]:{...k[m],homeGoals:g,awayGoals:y}}))}});const u=["FT","AET","PEN"];Object.keys(h).forEach(m=>{const l=s.find(y=>y.id===Number(m));if(!l)return;const n=Y.current[m],g=l.status;if(n&&!u.includes(n)&&u.includes(g)&&!xe.current.has(m)){xe.current.add(m);const y=h[m],N=l.goals?.home||0,_=l.goals?.away||0,G=y.isHome?N:_,C=y.isHome?_:N;let t="match_draw";G>C?t="match_won":G<C&&(t="match_lost"),te(l,y,t,N,_),setTimeout(()=>{X(d=>{const f={...d};return delete f[m],f})},15e3)}Y.current[m]=g}),L(s),Le(new Date),le(null)}catch(i){console.error("Error fetching live matches:",i),i.response?.status===500&&le("Server error. Please try again later.")}finally{a&&ce(!1)}},[]);c.useEffect(()=>{F(!0);const a=setInterval(()=>F(!1),45e3);return()=>clearInterval(a)},[F]),c.useEffect(()=>{(async()=>{ve(!0);try{const i=await ie.get("/api/fixtures/upcoming-all?days=3");console.log("[LiveScores] Upcoming fixtures loaded:",i.data.fixtures?.length||0),Ne(i.data.fixtures||[])}catch(i){console.error("[LiveScores] Upcoming fetch error:",i),Ne([])}ve(!1)})()},[]),c.useEffect(()=>{if(!T)return;const a=j.find(s=>s.id===T);if(!a||!["1H","2H","LIVE","ET","HT"].includes(a.status))return;const i=setInterval(()=>{delete ee.current[T],delete I.current[T],me(s=>{const p={...s};return delete p[T],p}),K(T,a.home_team.id,a.away_team.id,!0)},6e4);return()=>clearInterval(i)},[T,j,K]);const S=a=>["1H","2H","LIVE","ET","HT"].includes(a),q=a=>["FT","AET","PEN"].includes(a),Te=(a,i)=>{switch(a){case"1H":case"2H":case"LIVE":return`${i}'`;case"HT":return o("liveScores.halfTime");case"FT":return o("liveScores.fullTime");case"ET":return`ET ${i}'`;case"AET":return"AET";case"P":case"PEN":return"PEN";case"SUSP":return"SUSP";case"INT":return"INT";default:return a||"-"}},V=c.useMemo(()=>{const a={};return j.forEach(i=>{const s=`${i.competition?.id||"unknown"}`;a[s]||(a[s]={id:i.competition?.id,country:i.competition?.country||"Unknown",league:i.competition?.name||"Unknown",emblem:i.competition?.emblem,flag:i.competition?.flag,code:i.competition?.code,priority:as[i.competition?.id]||99,matches:[]}),a[s].matches.push(i)}),Object.values(a).forEach(i=>{i.matches.sort((s,p)=>{const r=U.includes(s.id)?0:1,h=U.includes(p.id)?0:1;if(r!==h)return r-h;const u=W.has(s.id)?0:1,m=W.has(p.id)?0:1;if(u!==m)return u-m;const l=n=>S(n)?0:n==="HT"?1:q(n)?3:2;return l(s.status)-l(p.status)})}),Object.values(a).sort((i,s)=>{const p=i.matches.some(h=>S(h.status)),r=s.matches.some(h=>S(h.status));return p&&!r?-1:!p&&r?1:i.priority!==s.priority?i.priority-s.priority:i.country.localeCompare(s.country)})},[j,U,W]),Ee=c.useMemo(()=>{const a=new Map;return V.forEach(i=>{a.has(i.country)||a.set(i.country,{name:i.country,flag:i.flag})}),Array.from(a.values())},[V]),Ie=c.useMemo(()=>$?V.filter(a=>a.country===$):V,[V,$]),Ue=a=>{const i=a.competition?.code||"PL";se(`/match/${i}/${a.home_team.id}/${a.away_team.id}`,{state:{fixture:a}})};if(Pe)return e.jsx("div",{className:"live-scores-page",children:e.jsxs("div",{className:"loading-container",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:o("common.loading")})]})});const Q=j.filter(a=>S(a.status)).length,_e=j.filter(a=>q(a.status)).length;return e.jsxs("div",{className:"live-scores-page",children:[e.jsxs("div",{className:"ls-view-tabs",children:[e.jsx("div",{className:"ls-view-slider",style:{transform:P==="upcoming"?"translateX(100%)":"translateX(0)"}}),e.jsxs("button",{className:`ls-view-tab ${P==="live"?"active":""}`,onClick:()=>we("live"),children:[e.jsx("span",{className:"live-dot"}),o("liveScores.title"),Q>0&&e.jsx("span",{className:"ls-tab-badge live",children:Q})]}),e.jsxs("button",{className:`ls-view-tab ${P==="upcoming"?"active":""}`,onClick:()=>we("upcoming"),children:["Upcoming Matches",!je&&B.length>0&&e.jsx("span",{className:"ls-tab-badge",children:Math.min(B.length,150)})]})]}),P==="live"&&Ee.length>0&&e.jsxs("div",{className:"country-filter-strip",children:[e.jsx("button",{className:`country-pill ${$?"":"active"}`,onClick:()=>be(null),children:"All"}),Ee.map(a=>e.jsxs("button",{className:`country-pill ${$===a.name?"active":""}`,onClick:()=>be(a.name),children:[a.flag&&e.jsx("img",{src:a.flag,alt:"",className:"country-pill-flag"}),e.jsx("span",{children:a.name})]},a.name))]}),P==="live"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"live-scores-header",children:e.jsxs("div",{className:"header-actions",children:[e.jsxs("div",{className:"live-stats-bar",children:[Q>0&&e.jsxs("span",{className:"live-stat live",children:[Q," ",o("fixtures.live")]}),_e>0&&e.jsxs("span",{className:"live-stat finished",children:[_e," ",o("liveScores.fullTime")]})]}),oe&&e.jsx("span",{className:"last-update-time",children:oe.toLocaleTimeString()}),e.jsx("button",{className:"refresh-btn",onClick:()=>F(!1),children:o("common.refresh")})]})}),J&&e.jsxs("div",{className:"error-banner",children:[J,e.jsx("button",{className:"retry-btn",onClick:()=>F(!0),children:"Try Again"})]}),!J&&j.length===0?e.jsxs("div",{className:"no-live-matches",children:[e.jsx("div",{className:"no-matches-icon",children:"âš½"}),e.jsx("h2",{children:o("liveScores.noLiveMatches")}),e.jsx("p",{children:o("liveScores.checkBackLater")}),e.jsx("p",{className:"hint-text",children:"Live matches from ALL leagues worldwide are shown when games are being played."})]}):e.jsx("div",{className:"live-leagues-container",children:Ie.map((a,i)=>e.jsxs("div",{className:"live-league-group",children:[e.jsxs("div",{className:"league-group-header",children:[a.flag?e.jsx("img",{src:a.flag,alt:"",className:"league-group-flag"}):a.emblem?e.jsx("img",{src:a.emblem,alt:"",className:"league-group-emblem"}):null,e.jsxs("div",{className:"league-group-info",children:[e.jsx("span",{className:"league-group-country",children:a.country}),e.jsx("span",{className:"league-group-name",children:a.league})]}),e.jsx("span",{className:"league-match-count",children:a.matches.length})]}),e.jsx("div",{className:"league-matches-list",children:a.matches.map(s=>{const p=W.has(s.id),r=U.includes(s.id),h=s.live_analysis;return e.jsxs("div",{children:[e.jsxs("div",{className:`live-match-row ${S(s.status)?"is-live":""} ${q(s.status)?"is-ft":""} ${p?"goal-flash":""}`,onClick:()=>De(s),children:[e.jsx("button",{className:`fav-star ${r?"active":""}`,onClick:u=>{u.stopPropagation(),Fe(s.id)},children:r?"â˜…":"â˜†"}),e.jsxs("div",{className:`match-row-status ${S(s.status)?"live":q(s.status)?"ft":""}`,children:[S(s.status)&&e.jsx("span",{className:"status-live-dot"}),Te(s.status,s.elapsed)]}),e.jsxs("div",{className:"match-row-teams",children:[e.jsxs("div",{className:"match-row-team home",children:[s.home_team.crest&&e.jsx("img",{src:s.home_team.crest,alt:"",className:"match-row-crest"}),e.jsx("span",{className:"match-row-name",children:s.home_team.name})]}),e.jsxs("div",{className:"match-row-team away",children:[s.away_team.crest&&e.jsx("img",{src:s.away_team.crest,alt:"",className:"match-row-crest"}),e.jsx("span",{className:"match-row-name",children:s.away_team.name})]})]}),e.jsxs("div",{className:`match-row-score ${p?"score-flash":""}`,children:[e.jsx("span",{className:S(s.status)?"score-live":"",children:s.goals?.home??0}),e.jsx("span",{className:"score-separator",children:"-"}),e.jsx("span",{className:S(s.status)?"score-live":"",children:s.goals?.away??0})]}),S(s.status)&&e.jsxs("div",{className:"track-btn-wrap",onClick:u=>u.stopPropagation(),children:[e.jsx("button",{className:`track-btn ${A[s.id]?"track-btn-active":""}`,onClick:()=>{A[s.id]?Ve(s.id):ge(pe===s.id?null:s.id)},children:A[s.id]?"ðŸ”” Tracking":"âš½ Track Match"}),pe===s.id&&e.jsxs("div",{className:"team-selector-popup",children:[e.jsx("div",{className:"team-selector-title",children:"Which team do you support?"}),e.jsxs("div",{className:"team-selector-options",children:[e.jsxs("button",{className:"team-selector-btn",onClick:()=>Se(s,s.home_team.id),children:[s.home_team.crest&&e.jsx("img",{src:s.home_team.crest,alt:"",className:"team-selector-crest"}),e.jsx("span",{children:s.home_team.name})]}),e.jsxs("button",{className:"team-selector-btn",onClick:()=>Se(s,s.away_team.id),children:[s.away_team.crest&&e.jsx("img",{src:s.away_team.crest,alt:"",className:"team-selector-crest"}),e.jsx("span",{children:s.away_team.name})]})]})]})]}),e.jsx("div",{className:"match-row-arrow",children:"â€º"})]}),T===s.id&&(()=>{const u=Re[s.id]||s.statistics,m=u&&(Object.keys(u.home||{}).length>0||Object.keys(u.away||{}).length>0),l=$e[s.id],n=s.events||[],g=n.filter(t=>t.type==="Goal"),y=g.filter(t=>t.team_id===s.home_team.id),N=g.filter(t=>t.team_id===s.away_team.id),_=t=>{const d=u?.home?.[t],f=u?.away?.[t];return{home:d,away:f,available:d!=null||f!=null}},G=(...t)=>{for(const d of t){const f=_(d);if(f.available)return{...f,foundKey:d}}return{home:null,away:null,available:!1,foundKey:null}},C=[{keys:["Ball Possession"],label:"Possession"},{keys:["Total Shots"],label:"Total Shots"},{keys:["Shots on Goal"],label:"Shots on Target"},{keys:["Shots off Goal"],label:"Shots off Target"},{keys:["Corner Kicks"],label:"Corners"},{keys:["Fouls"],label:"Fouls"},{keys:["Yellow Cards"],label:"Yellow Cards"},{keys:["Red Cards"],label:"Red Cards"},{keys:["Offsides"],label:"Offsides"},{keys:["Passes accurate","Passes Accurate"],label:"Accurate Passes"},{keys:["Passes %","Pass Accuracy"],label:"Pass Accuracy"},{keys:["expected_goals"],label:"Expected Goals (xG)"}].map(t=>{const d=G(...t.keys);return{...t,...d}}).filter(t=>t.available);return e.jsxs("div",{className:"match-expanded-panel",children:[e.jsxs("div",{className:"expanded-tabs",children:[e.jsx("button",{className:`expanded-tab ${M==="stats"?"active":""}`,onClick:t=>{t.stopPropagation(),D("stats")},children:"Stats"}),e.jsx("button",{className:`expanded-tab ${M==="events"?"active":""}`,onClick:t=>{t.stopPropagation(),D("events")},children:"Events"}),h&&S(s.status)&&e.jsx("button",{className:`expanded-tab ${M==="analysis"?"active":""}`,onClick:t=>{t.stopPropagation(),D("analysis")},children:"Analysis"})]}),M==="stats"&&e.jsxs("div",{className:"match-stats-panel",children:[e.jsxs("div",{className:"stats-score-header",children:[e.jsxs("div",{className:"stats-team-col home",children:[s.home_team.crest&&e.jsx("img",{src:s.home_team.crest,alt:"",className:"stats-team-crest"}),e.jsx("span",{className:"stats-team-name",children:s.home_team.name})]}),e.jsxs("div",{className:"stats-score-center",children:[e.jsxs("span",{className:"stats-score-num",children:[s.goals?.home??0," - ",s.goals?.away??0]}),e.jsx("span",{className:"stats-match-status",children:Te(s.status,s.elapsed)})]}),e.jsxs("div",{className:"stats-team-col away",children:[s.away_team.crest&&e.jsx("img",{src:s.away_team.crest,alt:"",className:"stats-team-crest"}),e.jsx("span",{className:"stats-team-name",children:s.away_team.name})]})]}),g.length>0&&e.jsxs("div",{className:"stats-scorers-row",children:[e.jsx("div",{className:"stats-scorers-col home",children:y.map((t,d)=>e.jsxs("span",{className:"stats-scorer",children:[t.player," ",t.time,"'"]},d))}),e.jsx("div",{className:"stats-scorers-col away",children:N.map((t,d)=>e.jsxs("span",{className:"stats-scorer",children:[t.player," ",t.time,"'"]},d))})]}),m&&C.length>0?e.jsx("div",{className:"stats-comparison",children:C.map(t=>{const d=t.home,f=t.away,v=typeof d=="string"?parseFloat(d):d||0,w=typeof f=="string"?parseFloat(f):f||0,k=v+w||1,Ce=Math.round(v/k*100),We=100-Ce,Xe=d??0,Ye=f??0;return e.jsxs("div",{className:"stat-comparison-row",children:[e.jsx("span",{className:`stat-val home ${v>w?"leading":""}`,children:Xe}),e.jsxs("div",{className:"stat-bar-section",children:[e.jsx("span",{className:"stat-label",children:t.label}),e.jsxs("div",{className:"stat-bar-track",children:[e.jsx("div",{className:`stat-bar-home ${v>w?"leading":v<w?"trailing":""}`,style:{width:`${Ce}%`}}),e.jsx("div",{className:`stat-bar-away ${w>v?"leading":w<v?"trailing":""}`,style:{width:`${We}%`}})]})]}),e.jsx("span",{className:`stat-val away ${w>v?"leading":""}`,children:Ye})]},t.label)})}):e.jsx("div",{className:"stats-unavailable",children:l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner",style:{width:20,height:20,margin:"0 auto 8px"}}),e.jsx("p",{children:o("common.loading")})]}):e.jsx("p",{children:"Statistics not yet available for this match."})})]}),M==="events"&&e.jsx("div",{className:"match-events-timeline",children:n.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"events-timeline-header",children:[e.jsx("span",{className:"etl-team-name",children:s.home_team.name}),e.jsx("span",{className:"etl-center-label",children:"Match Events"}),e.jsx("span",{className:"etl-team-name",children:s.away_team.name})]}),e.jsx("div",{className:"events-timeline-list",children:n.map((t,d)=>{const f=t.team_id===s.home_team.id,v=t.type==="Goal"?t.detail==="Own Goal"?"âš½âŒ":"âš½":t.type==="Card"?t.detail==="Red Card"?"ðŸŸ¥":t.detail==="Second Yellow card"?"ðŸŸ¨ðŸŸ¥":"ðŸŸ¨":t.type==="subst"?"ðŸ”„":"ðŸ“‹";return e.jsxs("div",{className:`etl-event ${f?"home":"away"}`,children:[f&&e.jsxs("div",{className:"etl-event-content home",children:[e.jsx("span",{className:"etl-player",children:t.player}),t.detail&&t.detail!==t.type&&e.jsx("span",{className:"etl-detail",children:t.detail})]}),e.jsxs("div",{className:"etl-time-col",children:[e.jsx("span",{className:"etl-icon",children:v}),e.jsxs("span",{className:"etl-time",children:[t.time,"'"]})]}),!f&&e.jsxs("div",{className:"etl-event-content away",children:[e.jsx("span",{className:"etl-player",children:t.player}),t.detail&&t.detail!==t.type&&e.jsx("span",{className:"etl-detail",children:t.detail})]})]},d)})})]}):e.jsx("div",{className:"stats-unavailable",children:e.jsx("p",{children:"No events recorded yet."})})}),M==="analysis"&&h&&S(s.status)&&e.jsxs("div",{className:"lma-container lma-compact",children:[[{key:"dom",label:"DOMINATION",data:h.domination},{key:"lts",label:"LIKELY TO SCORE",data:h.likely_next_goal},{key:"agg",label:"AGGRESSION",data:h.aggression}].filter(t=>t.data).map(t=>{const d=t.data.home||50,f=t.data.away||50,v=d>=f,w=v?"#22c55e":"#ef4444",k=v?"#ef4444":"#22c55e";return e.jsxs("div",{className:"lma-metric",children:[e.jsx("div",{className:"lma-label",children:t.label}),e.jsxs("div",{className:"lma-bar-row",children:[e.jsxs("span",{className:"lma-pct",style:{color:w},children:[d,"%"]}),e.jsxs("div",{className:"lma-track",children:[e.jsx("div",{className:"lma-fill-home",style:{width:`${d}%`,background:w,boxShadow:`0 0 12px ${w}88`}}),e.jsx("div",{className:"lma-fill-away",style:{width:`${f}%`,background:k,boxShadow:`0 0 12px ${k}88`}})]}),e.jsxs("span",{className:"lma-pct",style:{color:k},children:[f,"%"]})]}),e.jsxs("div",{className:"lma-teams",children:[e.jsx("span",{style:{color:w},children:s.home_team.name}),e.jsx("span",{style:{color:k},children:s.away_team.name})]})]},t.key)}),h.possession&&(()=>{const t=h.possession.home||50,d=h.possession.away||50;return e.jsxs("div",{className:"lma-metric",children:[e.jsx("div",{className:"lma-label",children:"POSSESSION"}),e.jsxs("div",{className:"lma-bar-row",children:[e.jsxs("span",{className:"lma-pct lma-pct-neutral",children:[t,"%"]}),e.jsxs("div",{className:"lma-track",children:[e.jsx("div",{className:"lma-fill-home lma-neutral-possession",style:{width:`${t}%`}}),e.jsx("div",{className:"lma-fill-away lma-neutral-possession-dim",style:{width:`${d}%`}})]}),e.jsxs("span",{className:"lma-pct lma-pct-neutral",children:[d,"%"]})]})]})})(),h.shots&&(()=>{const t=h.shots.home||0,d=h.shots.away||0,f=t+d||1,v=Math.round(t/f*100);return e.jsxs("div",{className:"lma-metric",children:[e.jsx("div",{className:"lma-label",children:"SHOTS"}),e.jsxs("div",{className:"lma-bar-row",children:[e.jsx("span",{className:"lma-pct lma-pct-neutral",children:t}),e.jsxs("div",{className:"lma-track",children:[e.jsx("div",{className:"lma-fill-home lma-neutral-shots",style:{width:`${v}%`}}),e.jsx("div",{className:"lma-fill-away lma-neutral-shots-dim",style:{width:`${100-v}%`}})]}),e.jsx("span",{className:"lma-pct lma-pct-neutral",children:d})]})]})})()]}),e.jsxs("div",{className:"expanded-actions",children:[e.jsx("button",{className:"full-analysis-btn",onClick:t=>{t.stopPropagation(),Ue(s)},children:"Full Match Analysis"}),e.jsx("div",{className:"match-live-chat-section",onClick:t=>t.stopPropagation(),children:e.jsxs("button",{className:"match-chat-toggle",onClick:()=>re({key:String(s.id),name:`${s.home_team.name} vs ${s.away_team.name}`}),children:[e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),e.jsx("span",{children:"Live Chat"})]})})]})]})})()]},s.id)})})]},i))})]}),P==="upcoming"&&e.jsx("div",{className:"upcoming-section-livescores",children:je?e.jsxs("div",{className:"loading-container",style:{padding:"24px 0"},children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading upcoming matches..."})]}):B.length===0?e.jsx("div",{style:{textAlign:"center",padding:"24px 0",color:"#64748b"},children:e.jsx("p",{children:"No upcoming matches found."})}):(()=>{const a=[...B].sort((l,n)=>new Date(l.date)-new Date(n.date)),i=15,p=a.slice(0,10*i),r=Math.max(1,Math.ceil(p.length/i)),h=p.slice((E-1)*i,E*i),u={};h.forEach(l=>{const n=l.date.split("T")[0];u[n]||(u[n]=[]),u[n].push(l)});const m=Object.keys(u).sort();return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"upcoming-fixtures-list",children:m.map(l=>e.jsxs("div",{className:"upcoming-date-group",children:[e.jsxs("div",{className:"upcoming-date-header",children:[e.jsx("span",{children:new Date(l+"T00:00:00").toLocaleDateString("en-GB",{weekday:"short",month:"short",day:"numeric"})}),e.jsxs("span",{className:"upcoming-date-count",children:[u[l].length," ",u[l].length!==1?"matches":"match"]})]}),e.jsx("div",{className:"upcoming-fixtures-grid",children:u[l].map(n=>{const g=x?.tier==="pro"||x?.tier==="trial",y=n.competition?.code||"PL";return e.jsxs("div",{className:`upcoming-fixture-card ${g?"":"pro-gated"}`,onClick:()=>{if(!g){se("/upgrade",{state:{from:"upcoming"}});return}se(`/match/${y}/${n.home_team.id}/${n.away_team.id}`,{state:{fixture:n,from:"upcoming"}})},children:[e.jsxs("div",{className:"upcoming-fixture-time",children:[new Date(n.date).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),n.competition?.name&&e.jsx("span",{className:"upcoming-fixture-league",children:n.competition.name})]}),e.jsxs("div",{className:"upcoming-fixture-teams",children:[e.jsxs("div",{className:"upcoming-team home",children:[n.home_team.crest&&e.jsx("img",{src:n.home_team.crest,alt:"",className:"upcoming-team-crest"}),e.jsx("span",{children:n.home_team.name})]}),e.jsx("span",{className:"upcoming-vs",children:"vs"}),e.jsxs("div",{className:"upcoming-team away",children:[e.jsx("span",{children:n.away_team.name}),n.away_team.crest&&e.jsx("img",{src:n.away_team.crest,alt:"",className:"upcoming-team-crest"})]})]}),e.jsx("div",{className:`upcoming-analyze-btn ${g?"":"pro-only"}`,children:g?"Analyze":"Pro Only"})]},n.id)})})]},l))}),r>1&&(()=>{let n=Math.max(1,E-Math.floor(2.5)),g=Math.min(r,n+5-1);g-n<4&&(n=Math.max(1,g-5+1));const y=[];for(let N=n;N<=g;N++)y.push(N);return e.jsxs("div",{className:"upcoming-pagination",children:[e.jsx("button",{className:"upcoming-page-btn",disabled:E<=1,onClick:()=>R(E-1),children:"Prev"}),n>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"upcoming-page-btn",onClick:()=>R(1),children:"1"}),n>2&&e.jsx("span",{className:"pagination-dots",children:"..."})]}),y.map(N=>e.jsx("button",{className:`upcoming-page-btn ${N===E?"active":""}`,onClick:()=>R(N),children:N},N)),g<r&&e.jsxs(e.Fragment,{children:[g<r-1&&e.jsx("span",{className:"pagination-dots",children:"..."}),e.jsx("button",{className:"upcoming-page-btn",onClick:()=>R(r),children:r})]}),e.jsx("button",{className:"upcoming-page-btn",disabled:E>=r,onClick:()=>R(E+1),children:"Next"})]})})()]})})()}),Z&&e.jsx(Qe,{matchKey:Z.key,matchName:Z.name,onClose:()=>re(null)}),b&&e.jsx("div",{className:"goal-notif-overlay",onClick:ke,children:e.jsxs("div",{className:`goal-notif-card goal-notif-${b.type}`,onClick:a=>a.stopPropagation(),children:[e.jsx("button",{className:"goal-notif-close",onClick:ke,children:"âœ•"}),e.jsx("div",{className:"goal-notif-headline",children:b.headline}),e.jsx("div",{className:"goal-notif-gif-wrap",children:b.gifUrl?e.jsx("img",{src:b.gifUrl,alt:"Goal reaction",className:"goal-notif-gif"}):e.jsxs("div",{className:"goal-notif-gif-loading",children:["âš½"," Loading..."]})}),e.jsxs("div",{className:"goal-notif-score-section",children:[e.jsxs("div",{className:"goal-notif-team",children:[b.homeCrest&&e.jsx("img",{src:b.homeCrest,alt:"",className:"goal-notif-crest"}),e.jsx("span",{children:b.homeTeam})]}),e.jsxs("div",{className:"goal-notif-score",children:[b.homeGoals," - ",b.awayGoals]}),e.jsxs("div",{className:"goal-notif-team",children:[e.jsx("span",{children:b.awayTeam}),b.awayCrest&&e.jsx("img",{src:b.awayCrest,alt:"",className:"goal-notif-crest"})]})]}),e.jsx("div",{className:"goal-notif-sub",children:b.subMessage}),e.jsxs("div",{className:"goal-notif-tracked",children:[b.trackedCrest&&e.jsx("img",{src:b.trackedCrest,alt:"",className:"goal-notif-tracked-crest"}),"Tracking: ",b.trackedTeam]}),e.jsx("div",{className:"goal-notif-dismiss",children:"Tap anywhere to dismiss"})]})})]})}export{ls as default};
