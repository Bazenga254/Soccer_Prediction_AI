import{u as B,a as M,f as E,r as o,c as w,j as s}from"./index-B3SC9TNl.js";const u=10,W=({type:i})=>{const c={deposit:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s.jsx("polyline",{points:"19 12 12 19 5 12"})]}),withdrawal:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"5"}),s.jsx("polyline",{points:"5 12 12 5 19 12"})]}),subscription:s.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:s.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})}),purchase:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"9",cy:"21",r:"1"}),s.jsx("circle",{cx:"20",cy:"21",r:"1"}),s.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),sale:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"23"}),s.jsx("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"})]}),earning:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("polyline",{points:"20 12 20 22 4 22 4 12"}),s.jsx("rect",{x:"2",y:"7",width:"20",height:"5"}),s.jsx("line",{x1:"12",y1:"22",x2:"12",y2:"7"}),s.jsx("path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"}),s.jsx("path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"})]}),deduction:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]}),adjustment:s.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("circle",{cx:"12",cy:"12",r:"10"}),s.jsx("line",{x1:"12",y1:"8",x2:"12",y2:"16"}),s.jsx("line",{x1:"8",y1:"12",x2:"16",y2:"12"})]})};return c[i]||c.deduction},$=i=>i?new Date(i).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"";function F(){const{t:i}=B(),{user:c}=M(),{isKenyan:d}=E(),[x,L]=o.useState([]),[h,C]=o.useState(0),[k,b]=o.useState("all"),[t,v]=o.useState(1),[l,N]=o.useState(!0),[m,T]=o.useState(130),r=Math.max(1,Math.ceil(h/u)),p=async(e="all",n=1)=>{N(!0);try{const g=(n-1)*u,a=await w.get("/api/user/transactions",{params:{filter:e,offset:g,limit:u}});L(a.data.transactions),C(a.data.total)}catch{}finally{N(!1)}};o.useEffect(()=>{p()},[]),o.useEffect(()=>{d&&w.post("/api/payment/quote",{amount_usd:1}).then(e=>{e.data.amount_kes&&T(e.data.amount_kes)}).catch(()=>{})},[d]);const j=(e,n)=>d&&n==="USD"?{amount:Math.round(e*m),currency:"KES"}:!d&&n==="KES"?{amount:m>0?+(e/m).toFixed(2):e,currency:"USD"}:{amount:e,currency:n},f=(e,n)=>n==="KES"?`KES ${Math.abs(e).toLocaleString()}`:`$${Math.abs(e).toFixed(2)}`,_=e=>{b(e),v(1),p(e,1)},y=e=>{e<1||e>r||e===t||(v(e),p(k,e))},S=()=>{const e=[];if(r<=7)for(let n=1;n<=r;n++)e.push(n);else{e.push(1),t>3&&e.push("...");const n=Math.max(2,t-1),g=Math.min(r-1,t+1);for(let a=n;a<=g;a++)e.push(a);t<r-2&&e.push("..."),e.push(r)}return e};return c?s.jsx("div",{className:"profile-page",children:s.jsxs("div",{className:"profile-container",children:[s.jsx("h2",{className:"profile-title",children:i("profile.transactions")}),s.jsx("p",{className:"profile-section-desc",style:{marginBottom:16},children:i("profile.transactionsDesc")}),s.jsxs("div",{className:"profile-transactions",children:[s.jsx("div",{className:"txn-filter-tabs",children:["all","payments","withdrawals","earnings","deductions"].map(e=>s.jsx("button",{className:`txn-filter-tab ${k===e?"active":""}`,onClick:()=>_(e),children:i(`profile.txnFilter_${e}`)},e))}),s.jsxs("div",{className:"txn-list",children:[x.length===0&&!l&&s.jsx("div",{className:"txn-empty",children:i("profile.noTransactions")}),l&&x.length===0&&s.jsx("div",{className:"txn-empty",children:i("common.loading")}),x.map(e=>s.jsxs("div",{className:"txn-item",children:[s.jsx("div",{className:`txn-icon-wrap txn-icon-${e.type}`,children:s.jsx(W,{type:e.type})}),s.jsxs("div",{className:"txn-details",children:[s.jsx("div",{className:"txn-desc",children:e.description}),s.jsxs("div",{className:"txn-meta",children:[s.jsx("span",{className:"txn-date",children:$(e.date)}),e.payment_method&&s.jsx("span",{className:"txn-method",children:e.payment_method.toUpperCase()}),e.reference&&s.jsxs("span",{className:"txn-ref",children:["Ref: ",e.reference]})]}),e.fee>0&&s.jsxs("div",{className:"txn-fee",children:["Fee: ",(()=>{const n=j(e.fee,e.fee_currency||e.currency);return f(n.amount,n.currency)})(),e.fee_description&&s.jsx("span",{className:"txn-fee-info",title:e.fee_description,children:" (?)"})]})]}),s.jsxs("div",{className:"txn-amount-col",children:[(()=>{const n=j(e.amount,e.currency);return s.jsxs("span",{className:`txn-amount ${e.amount>=0?"positive":"negative"}`,children:[e.amount>=0?"+":"-",f(n.amount,n.currency)]})})(),e.amount_secondary!=null&&e.currency_secondary&&s.jsx("span",{className:"txn-amount-secondary",children:(()=>{const n=j(e.amount_secondary,e.currency_secondary);return f(n.amount,n.currency)})()}),s.jsx("span",{className:`txn-status txn-status-${e.status}`,children:e.status})]})]},e.id))]}),h>u&&s.jsxs("div",{className:"txn-pagination",children:[s.jsx("button",{className:"txn-page-btn",onClick:()=>y(t-1),disabled:t<=1||l,children:s.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("polyline",{points:"15 18 9 12 15 6"})})}),S().map((e,n)=>e==="..."?s.jsx("span",{className:"txn-page-dots",children:"..."},`dots-${n}`):s.jsx("button",{className:`txn-page-btn ${e===t?"active":""}`,onClick:()=>y(e),disabled:l,children:e},e)),s.jsx("button",{className:"txn-page-btn",onClick:()=>y(t+1),disabled:t>=r||l,children:s.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:s.jsx("polyline",{points:"9 18 15 12 9 6"})})})]}),h>0&&s.jsxs("div",{className:"txn-count",children:["Page ",t," of ",r," (",h," transactions)"]})]})]})}):null}export{F as default};
