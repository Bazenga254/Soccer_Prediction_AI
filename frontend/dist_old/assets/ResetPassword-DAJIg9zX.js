import{u as R,h as q,b as M,r,j as s,c as A}from"./index-B3SC9TNl.js";function I(){const{t:e}=R(),[x]=q(),c=M(),h=x.get("token")||"",i=x.get("email")||"",[o,N]=r.useState(""),[g,P]=r.useState(""),[m,b]=r.useState(!1),[w,v]=r.useState(!1),[p,n]=r.useState(""),[d,j]=r.useState(!1),[f,k]=r.useState(!1),y=t=>[{label:e("auth.pwdReq1"),met:t.length>=8},{label:e("auth.pwdReq2"),met:(t.match(/[A-Z]/g)||[]).length>=2},{label:e("auth.pwdReq3"),met:(t.match(/[a-z]/g)||[]).length>=2},{label:e("auth.pwdReq4"),met:(t.match(/[0-9]/g)||[]).length>=2},{label:e("auth.pwdReq5"),met:(t.match(/[^A-Za-z0-9]/g)||[]).length>=2}],l=r.useMemo(()=>y(o),[o,e]),u=l.filter(t=>t.met).length/l.length*100,C=u<=40?"#ef4444":u<=80?"#f59e0b":"#22c55e",S=async t=>{if(t.preventDefault(),n(""),!h||!i){n(e("resetPassword.invalidResetRequest"));return}if(!o.trim()){n(e("resetPassword.enterNewPassword"));return}if(o!==g){n(e("resetPassword.passwordsNoMatch"));return}if(!l.every(a=>a.met)){n(e("resetPassword.meetRequirements"));return}j(!0);try{const a=await A.post("/api/user/reset-password",{email:i,token:h,new_password:o});a.data.success?k(!0):n(a.data.error||e("auth.somethingWrong"))}catch(a){n(a.response?.data?.detail||e("resetPassword.failedReset"))}j(!1)};return!h||!i?s.jsx("div",{className:"reset-password-page",children:s.jsxs("div",{className:"reset-password-card",children:[s.jsxs("div",{className:"gate-brand",children:[s.jsx("span",{className:"gate-logo",children:"⚽"}),s.jsx("h1",{className:"gate-title",children:e("auth.sparkAIPrediction")})]}),s.jsx("div",{className:"gate-error",children:e("resetPassword.invalidResetLinkFull")}),s.jsx("button",{className:"gate-submit-btn",onClick:()=>c("/"),children:e("resetPassword.goToLogin")})]})}):f?s.jsx("div",{className:"reset-password-page",children:s.jsxs("div",{className:"reset-password-card",children:[s.jsxs("div",{className:"gate-brand",children:[s.jsx("span",{className:"gate-logo",children:"⚽"}),s.jsx("h1",{className:"gate-title",children:e("auth.sparkAIPrediction")})]}),s.jsxs("div",{className:"reset-success",children:[s.jsx("div",{className:"reset-success-icon",children:s.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#22c55e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),s.jsx("h2",{className:"reset-success-title",children:e("resetPassword.passwordResetSuccessTitle")}),s.jsx("p",{className:"reset-success-message",children:e("resetPassword.passwordResetSuccessMessage")}),s.jsx("button",{className:"gate-submit-btn",onClick:()=>c("/"),children:e("resetPassword.goToLogin")})]})]})}):s.jsx("div",{className:"reset-password-page",children:s.jsxs("div",{className:"reset-password-card",children:[s.jsxs("div",{className:"gate-brand",children:[s.jsx("span",{className:"gate-logo",children:"⚽"}),s.jsx("h1",{className:"gate-title",children:e("auth.sparkAIPrediction")})]}),s.jsx("h2",{className:"reset-heading",children:e("resetPassword.createNewPassword")}),s.jsx("p",{className:"reset-subtitle",dangerouslySetInnerHTML:{__html:e("resetPassword.newPasswordFor",{email:i})}}),s.jsxs("form",{onSubmit:S,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"new-password",children:e("resetPassword.newPassword")}),s.jsxs("div",{className:"password-input-wrapper",children:[s.jsx("input",{id:"new-password",type:m?"text":"password",value:o,onChange:t=>N(t.target.value),placeholder:e("resetPassword.createStrongPassword"),disabled:d,autoFocus:!0}),s.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>b(!m),tabIndex:-1,children:m?s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),s.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),o.length>0&&s.jsxs("div",{className:"password-requirements",children:[s.jsx("div",{className:"password-strength-bar",children:s.jsx("div",{className:"password-strength-fill",style:{width:`${u}%`,background:C}})}),s.jsx("ul",{className:"password-req-list",children:l.map((t,a)=>s.jsxs("li",{className:t.met?"req-met":"req-unmet",children:[s.jsx("span",{className:"req-icon",children:t.met?"✓":"✗"}),t.label]},a))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"confirm-password",children:e("resetPassword.confirmNewPassword")}),s.jsxs("div",{className:"password-input-wrapper",children:[s.jsx("input",{id:"confirm-password",type:w?"text":"password",value:g,onChange:t=>P(t.target.value),placeholder:e("resetPassword.confirmYourPassword"),disabled:d}),s.jsx("button",{type:"button",className:"password-toggle-btn",onClick:()=>v(!w),tabIndex:-1,children:w?s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),s.jsx("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):s.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[s.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),s.jsx("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),p&&s.jsx("div",{className:"gate-error",children:p}),s.jsx("button",{type:"submit",className:"gate-submit-btn",disabled:d||!l.every(t=>t.met),children:e(d?"resetPassword.resettingPassword":"resetPassword.resetBtn")})]}),s.jsx("div",{className:"gate-footer",children:s.jsxs("p",{children:[e("resetPassword.rememberPassword")," ",s.jsx("button",{className:"link-btn",onClick:()=>c("/"),children:e("resetPassword.backToLoginLink")})]})})]})})}export{I as default};
